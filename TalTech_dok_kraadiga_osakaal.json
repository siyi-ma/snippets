{"name":"TalTech_dok_kraadiga_osakaal","version":"1.0","culture":"en-US","modifiedTime":"2025-04-09T19:47:22.3787196+00:00","ppdf:outputFileFormat":"parquet","ppdf:dataflowId":"2861c5be-80e1-44cc-8d7a-bdc77c66dbae","ppdf:owner":{"tenantId":"3efd4d88-9b88-4fc9-b6c0-c7ca50f1db57","userId":"84427c2b-9e9c-4069-a4ef-32e34b3e92fb"},"ppdf:fastCopy":true,"pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"source_S24_KT":{"queryId":"8835faf2-3a79-49ec-b386-7a95238578f0","queryName":"source_S24_KT"},"_folderOisParing":{"queryId":"f959d9b5-df00-4332-a7eb-233a07119937","queryName":"_folderOisParing"},"vordlus_oppejoud_PhD":{"queryId":"c5dd54d0-2b04-4277-8a08-f3851ae2aeb2","queryName":"vordlus_oppejoud_PhD"},"source2023_24":{"queryId":"4b33c060-04e2-4748-9fec-1ef5af5121b6","queryName":"source2023_24","queryGroupId":"6537e7a9-ec58-4c5f-aa2f-ff29ac3e3151"},"source2023_24_KT":{"queryId":"9a314b96-8459-4972-a480-fbaa8dc72585","queryName":"source2023_24_KT","queryGroupId":"6537e7a9-ec58-4c5f-aa2f-ff29ac3e3151"},"data2324":{"queryId":"5127c00c-bafe-4d9e-917c-c3ae0d4968b6","queryName":"data2324","queryGroupId":"6537e7a9-ec58-4c5f-aa2f-ff29ac3e3151","loadEnabled":true},"juhendamised2324":{"queryId":"253f880c-fdba-4368-b797-2355521159b1","queryName":"juhendamised2324","queryGroupId":"6537e7a9-ec58-4c5f-aa2f-ff29ac3e3151","loadEnabled":true},"dim_kava2324":{"queryId":"34b31d34-520c-4cd3-81ea-eb124478da6a","queryName":"dim_kava2324","queryGroupId":"6537e7a9-ec58-4c5f-aa2f-ff29ac3e3151","loadEnabled":true},"data2324_M_oppejoud":{"queryId":"bc42a6d7-98b3-433c-91c3-fdfd594b82f9","queryName":"data2324_M_oppejoud","queryGroupId":"6537e7a9-ec58-4c5f-aa2f-ff29ac3e3151"},"lookup_M_tippspetsialist":{"queryId":"a45a5126-9dd5-44f6-955b-97a82acff399","queryName":"lookup_M_tippspetsialist","queryGroupId":"6537e7a9-ec58-4c5f-aa2f-ff29ac3e3151"},"lookup_M_oppejoudKontrollitud2024_06":{"queryId":"676037fc-70f8-4696-8544-f60541c9e9ce","queryName":"lookup_M_oppejoudKontrollitud2024_06","queryGroupId":"6537e7a9-ec58-4c5f-aa2f-ff29ac3e3151"},"_test_tblrowcount":{"queryId":"9cee2813-f852-4115-8bc8-5041ad80c5db","queryName":"_test_tblrowcount","queryGroupId":"6537e7a9-ec58-4c5f-aa2f-ff29ac3e3151"}},"document":"section Section1;\r\nshared source_S24_KT = let\n    Source = _folderOisParing,\n    getExcel = Excel.Workbook( Source{[Name=\"dok kraadiga osakaal S24_08.04.2025 seis.xlsx\"]}[Content], true, true),\n    koondtabel_Sheet = getExcel{[Item=\"koondtabel\",Kind=\"Sheet\"]}[Data],\n    #\"Filtered Rows\" = Table.SelectRows(koondtabel_Sheet, each [#\"oli vastuvõtuks avatud ja toimus kontaktõpe 24/25\"] = true),\n    #\"Removed Columns\" = Table.RemoveColumns(#\"Filtered Rows\",{\"Grand Total\", \"õppekava nimetus\", \"oli vastuvõtuks avatud ja toimus kontaktõpe 24/25\"}),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Removed Columns\", {{\"semester\", \"oppeaasta\"}, {\"ainekood/lõputöö\", \"ainekood\"}, {\"aine/lõputöö EAP\", \"aine EAP\"}}),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Renamed columns\", {{\"oppeaasta\", type text}, {\"õppekava\", type text}, {\"ainekood\", type text}, {\"aine EAP\", Int64.Type}, {\"õppejõud\", type text}, {\"dok_JAH\", type number}, {\"dok_EI\", type number}, {\"teaduskond\", type text}, {\"õppetase\", type text}, {\"eesmärk\", type number}}),\r\n  #\"Unpivoted columns\" =  Table.SelectRows( Table.UnpivotOtherColumns(#\"Changed column type\", {\"oppeaasta\", \"teaduskond\", \"õppetase\", \"õppekava\", \"eesmärk\", \"ainekood\", \"aine EAP\", \"õppejõud\"}, \"haridus kahesüsteemne\", \"value\"), each [value]>0)\nin\n    #\"Unpivoted columns\";\r\nshared _folderOisParing = let\n    Source = SharePoint.Contents(\"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee\"),\n    Documents = Source{[Name=\"Documents\"]}[Content],\n    ÕIS = Documents{[Name=\"ÕIS\"]}[Content],\n    #\"ÕIS päring\" = ÕIS{[Name=\"ÕIS päring\"]}[Content]\nin\n    #\"ÕIS päring\";\r\nshared vordlus_oppejoud_PhD = let\n    Source = source2023_24,\n    uus = Table.Distinct( Table.SelectColumns(Source,{\"õppejõud tunniplaanis (nimi)\", \"Semester\", \"haridus kahesüsteemne\"})),\n    #\"Removed Other Columns\" = Table.Distinct( Table.SelectColumns(uus,{\"õppejõud tunniplaanis (nimi)\", \"Semester\", \"haridus kahesüsteemne\"})),\n    #\"Grouped Rows\" = Table.Sort( Table.Group(#\"Removed Other Columns\", {\"õppejõud tunniplaanis (nimi)\"}, {{\"Count\", each Table.RowCount(_), Int64.Type}, {\"all\", each _, type table}}), {{\"Count\", Order.Descending}}),\n    #\"Added Custom\" = Table.AddColumn(#\"Grouped Rows\", \"dok.kraadi uus failis\", each let value1 = [all][haridus kahesüsteemne]{0}, \nvalue2 = [all][haridus kahesüsteemne]{1},\ncompare = if value1 = value2 then value1 else \"S23 \"& value1 & \" | \"&\"K24 \"&value2, result= if [Count] = 2 then compare else value1 in result, type text),\n    #\"Added Custom1\" = Table.AddColumn(#\"Added Custom\", \"dok.kraadi vana failis\", each let list0 = List.Buffer(source2023_24_vana[#\"õppejõud tunniplaanis (nimi)\"]), \nlist1 = List.Buffer(source2023_24_vana[#\"haridus kahesüsteemne\"]),\nresult = try list1{List.PositionOf(list0, [#\"õppejõud tunniplaanis (nimi)\"])} otherwise \"\" in result, type text),\n    #\"Added Custom2\" = Table.AddColumn(#\"Added Custom1\", \"vordlus\", each if [dok.kraadi uus failis] = [dok.kraadi vana failis] then \"\" else \"eraldi\", type text),\n    #\"Sorted Rows\" = Table.Sort(#\"Added Custom2\",{{\"vordlus\", Order.Descending}, {\"dok.kraadi vana failis\", Order.Ascending}}),\n    #\"Removed Columns\" = Table.RemoveColumns(#\"Sorted Rows\",{\"Count\", \"all\"})\nin\n    #\"Removed Columns\";\r\nshared source2023_24 = let\n    Source = _folderOisParing,\n    getExcel = Excel.Workbook( Source{[Name=\"23-24 õa_semestrid eraldi.xlsx\"]}[Content], true, true),\n    S23 = Table.RemoveColumns(\n        Table.SelectRows( \n        getExcel{[Name=\"sügis 2024\",Kind=\"Sheet\"]}[Data],\n        each [#\"oli vastuvõtuks avatud ja toimus kontaktõpe 23/24\"] = true),\n        {\"oli vastuvõtuks avatud ja toimus kontaktõpe 23/24\", \"Grand Total\", \"õppekava nimetus\"}),\n    renameColS23 = Table.RenameColumns(S23, {{\"ainekood/lõputöö\", \"ainekood\"}, {\"aine/lõputöö EAP\", \"aine EAP\"}}),\n    addSemesterS23 = Table.AddColumn(\n        Table.TransformColumnTypes(renameColS23,{{\"õppekava\", type text}, {\"ainekood\", type text}, {\"aine EAP\", Int64.Type}, {\"õppejõud\", type text}, {\"dok_EI\", type number}, {\"dok_JAH\", type number}, {\"teaduskond\", type text}, {\"õppetase\", type text}, {\"eesmärk\", type number}}),\n            \"semester\", each \"2023/2024 sügis\", type text),\n    unpivotS23 = Table.UnpivotOtherColumns(addSemesterS23, { \"semester\", \"eesmärk\", \"õppekava\", \"ainekood\", \"aine EAP\", \"õppejõud\", \"teaduskond\", \"õppetase\"}, \"haridus kahesüsteemne\", \"value\"),\n    K24 =Table.RemoveColumns(\n        Table.SelectRows( \n        getExcel{[Name=\"kevad 2024\",Kind=\"Sheet\"]}[Data],\n        each ([#\"oli vastuvõtuks avatud ja toimus kontaktõpe 23/24\"] = true)),\n        { \"oli vastuvõtuks avatud ja toimus kontaktõpe 23/24\", \"Grand Total\", \"õppekava nimetus\"}),\r\n  #\"Renamed columns\" = Table.RenameColumns(K24, {{\"õppejõud tunniplaanis (nimi)\", \"õppejõud\"}, {\"rühmaga seotud õppekava\", \"õppekava\"}}),\n    addSemesterK24 = Table.AddColumn(\n        Table.TransformColumnTypes(#\"Renamed columns\",{{\"õppekava\", type text}, {\"ainekood\", type text}, {\"aine EAP\", Int64.Type}, {\"õppejõud\", type text}, {\"dok_EI\", type number}, {\"dok_JAH\", type number}, {\"teaduskond\", type text}, {\"õppetase\", type text}, {\"eesmärk\", type number}}),\n        \"semester\", each \"2023/2024 kevad\", type text),\n    unpivotK24 = Table.UnpivotOtherColumns(addSemesterK24, { \"semester\", \"eesmärk\", \"õppekava\", \"ainekood\", \"aine EAP\", \"õppejõud\", \"teaduskond\", \"õppetase\"}, \"haridus kahesüsteemne\", \"value\"),\n    Custom1 = Table.Combine({unpivotS23, unpivotK24})\nin\n    Custom1;\r\nshared source2023_24_KT = let\n    Source = _folderOisParing,\n    getExcel = Excel.Workbook( Source{[Name=\"tulmused ja algandmed jagamiseks_dok osakaal 23-24.xlsx\"]}[Content], true, true),\n    algandmed_Sheet = getExcel{[Item=\"algandmed\",Kind=\"Sheet\"]}[Data],\n    #\"Filtered Rows\" = Table.SelectRows(algandmed_Sheet, each [#\"oli vastuvõtuks avatud ja toimus kontaktõpe 23/24\"] = true and [#\"lõputöö kaitstud kujal\"]<> \"jah\"),\n    #\"Removed Columns\" = Table.RemoveColumns(#\"Filtered Rows\",{\"Grand Total\", \"õppekava nimetus\", \"oli vastuvõtuks avatud ja toimus kontaktõpe 23/24\", \"lõputöö kaitstud kujal\"}),\r\n  renameCols = Table.TransformColumnTypes(\r\nTable.RenameColumns(#\"Removed Columns\", {{\"rühmaga seotud õppekava\", \"õppekava\"}, {\"õppejõud tunniplaanis (nimi)\", \"õppejõud\"}}),\r\n{{\"õppekava\", type text}, {\"ainekood\", type text}, {\"aine EAP\", Int64.Type}, {\"õppejõud\", type text}, {\"dok_EI\", type number}, {\"dok_JAH\", type number}, {\"õppetase\", type text}, {\"eesmärk\", type number}, {\"teaduskond\", type text}}),\r\n  addOppeaasta = Table.AddColumn(renameCols, \"oppeaasta\", each \"2023/24\", type text),\n    #\"Unpivoted Columns\" = Table.SelectRows(\r\nTable.UnpivotOtherColumns(addOppeaasta, {\"oppeaasta\", \"eesmärk\", \"õppekava\",  \"ainekood\", \"aine EAP\", \"õppejõud\", \"õppetase\", \"teaduskond\"}, \"haridus kahesüsteemne\", \"value\"), each [value]>0),\r\n  #\"Appended query\" = Table.Combine({#\"Unpivoted Columns\", source_S24_KT})\nin\n    #\"Appended query\";\r\nshared data2324 = let\n    Source = source2023_24_KT,\r\n  #\"Removed columns\" = Table.RemoveColumns(Source, {\"teaduskond\", \"õppetase\", \"eesmärk\"}),\n    #\"Filtered Rows\" = Table.SelectRows(#\"Removed columns\", each [ainekood] <> \"lõputöö\"),\n    #\"Added Custom\" = Table.AddColumn(#\"Filtered Rows\", \"nimi_haridus\", each [#\"õppejõud\"] & \" | \" &[haridus kahesüsteemne], type text)\nin\n    #\"Added Custom\";\r\nshared juhendamised2324 = let\r\n  Source = source2023_24_KT,\r\n  Custom =  Table.SelectRows(Source, each [ainekood] = \"lõputöö\")\r\nin\r\n  Custom;\r\nshared dim_kava2324 = let\r\n  Source = source2023_24_KT,\r\n  Custom = Table.Distinct( Table.SelectColumns(Source,{\"õppekava\", \"teaduskond\", \"õppetase\", \"eesmärk\"}))\r\nin\r\n  Custom;\r\nshared data2324_M_oppejoud = let\n    Source = source2023_24,\n    #\"Filtered Rows\" = Table.SelectRows(Source, each ([teaduskond] = \"M - majandusteaduskond\")),\n    #\"Removed Other Columns\" = Table.Distinct( Table.SelectColumns(#\"Filtered Rows\",{\"semester\", \"õppejõud\", \"haridus kahesüsteemne\"})),\n    #\"Grouped Rows\" = Table.Group(#\"Removed Other Columns\", {\"semester\", \"õppejõud\"}, {{\"haridusKahesystemne\", each Text.Combine(_[#\"haridus kahesüsteemne\"], \", \"), type text}}),\n    #\"Added Custom\" = Table.AddColumn(#\"Grouped Rows\", \"M2024_juuniKontrollitud\", each let list0 = List.Buffer(lookup_M_oppejoudKontrollitud2024_06[nimi]), \nlist1 = (lookup_M_oppejoudKontrollitud2024_06[haridus]),\nresult = try list1{List.PositionOf(list0, [#\"õppejõud tunniplaanis (nimi)\"])} otherwise \"NA\" in result, type text),\n    #\"Added Custom1\" = Table.AddColumn(#\"Added Custom\", \"kasTippspetsialist\", each let list0 = List.Buffer(lookup_M_tippspetsialist[nimi]), \n_position = List.PositionOf(list0, [#\"õppejõud tunniplaanis (nimi)\"]), \nresult = if _position >=0 then \"jah\" else \"ei\" in result, type text)\nin\n    #\"Added Custom1\";\r\nshared lookup_M_tippspetsialist = let\n    Source = _folderOisParing,\n    getExcel = Excel.Workbook( Source{[Name=\"Majanduse senised tippspetsialistid_2024_juuni_kontrollitud.xlsx\"]}[Content], true, true),\n    Sheet1_Sheet = getExcel{[Item=\"Sheet1\",Kind=\"Sheet\"]}[Data],\n    #\"Filtered Rows\" = Table.SelectRows(Sheet1_Sheet, each ([Column1] <> null)),\n    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Filtered Rows\", [PromoteAllScalars=true]),\n    #\"Changed Type\" = Table.TransformColumnTypes(#\"Promoted Headers\",{{\"No\", Int64.Type}, {\"Instituut\", type text}, {\"perenimi\", type text}, {\"eesnimi\", type text}, {\"kraad\", type text}, {\"ametikoht\", type text}, {\"on tipp-praktikukandidaat\", type any}, {\"kontakttunde õppeaastas\", Int64.Type}, {\"meil õpetanud aastast? Aasta või üle 5a\", type any}, {\"Õppeaine\", type text}, {\"isikukood\", type any}, {\"nimi\", type text}})\nin\n    #\"Changed Type\";\r\nshared lookup_M_oppejoudKontrollitud2024_06 = let\n    Source = _folderOisParing,\n    getExcel = Excel.Workbook( Source{[Name=\"Majanduse õppejõud 2024_juuni_kontrollitud.xlsx\"]}[Content], true, true),\n    Sheet1_Sheet = getExcel{[Item=\"Sheet1\",Kind=\"Sheet\"]}[Data],\n    #\"Removed Columns\" = Table.RemoveColumns(Sheet1_Sheet,{\"Column6\", \"Column7\", \"Column8\", \"Column9\"}),\n    #\"Changed Type\" = Table.TransformColumnTypes(#\"Removed Columns\",{{\"nimi\", type text}, {\"isikukood\", Int64.Type}, {\"sünniaeg (kui isikukood puudub)\", Int64.Type}, {\"struktuuriüks\", type text}, {\"haridus\", type text}})\nin\n    #\"Changed Type\";\r\nshared _test_tblrowcount = let\r\n  Source = juhendamised2324,\r\n  selectRows = Table.SelectRows( Source, each [oppeaasta] = \"2023/24\"),\r\n  tblRowCount = Table.RowCount(selectRows)\r\nin\r\n  tblRowCount;\r\n","connectionOverrides":[{"path":"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee\"}","audience":null}]},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"Id\":\"6537e7a9-ec58-4c5f-aa2f-ff29ac3e3151\",\"Name\":\"2023/24\",\"Description\":\"\",\"ParentId\":null,\"Order\":0}]"}],"entities":[{"$type":"LocalEntity","name":"data2324","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"data2324.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"õppekava","dataType":"string"},{"name":"ainekood","dataType":"string"},{"name":"aine EAP","dataType":"int64"},{"name":"õppejõud","dataType":"string"},{"name":"oppeaasta","dataType":"string"},{"name":"haridus kahesüsteemne","dataType":"string"},{"name":"value","dataType":"double"},{"name":"nimi_haridus","dataType":"string"}]},{"$type":"LocalEntity","name":"juhendamised2324","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"juhendamised2324.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"õppekava","dataType":"string"},{"name":"ainekood","dataType":"string"},{"name":"aine EAP","dataType":"int64"},{"name":"õppejõud","dataType":"string"},{"name":"teaduskond","dataType":"string"},{"name":"õppetase","dataType":"string"},{"name":"eesmärk","dataType":"double"},{"name":"oppeaasta","dataType":"string"},{"name":"haridus kahesüsteemne","dataType":"string"},{"name":"value","dataType":"double"}]},{"$type":"LocalEntity","name":"dim_kava2324","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"dim_kava2324.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[{\"columns\":[\"õppekava\",\"teaduskond\",\"õppetase\",\"eesmärk\"]}]"}],"attributes":[{"name":"õppekava","dataType":"string"},{"name":"teaduskond","dataType":"string"},{"name":"õppetase","dataType":"string"},{"name":"eesmärk","dataType":"double"}]}]}