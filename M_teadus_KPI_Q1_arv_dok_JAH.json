{"name":"M_teadus_KPI_Q1_arv_dok_JAH","version":"1.0","culture":"en-US","modifiedTime":"2025-05-06T11:24:36.9450457+00:00","ppdf:outputFileFormat":"parquet","ppdf:dataflowId":"d4fb7895-7807-49f8-99e1-6052163fd99f","ppdf:owner":{"tenantId":"3efd4d88-9b88-4fc9-b6c0-c7ca50f1db57","userId":"84427c2b-9e9c-4069-a4ef-32e34b3e92fb"},"ppdf:fastCopy":true,"pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"fn_extractMAJcsv":{"queryId":"2bc21ef1-f330-46d9-a2a5-5f6a49bd383c","queryName":"fn_extractMAJcsv","queryGroupId":"5c250137-c863-4bf0-9e0d-202f5fbcf206"},"_folder_M_teadus_KPI":{"queryId":"2ef050c2-2564-4456-898d-c172af88f243","queryName":"_folder_M_teadus_KPI"},"_folder_M_teadus_KPI_csv":{"queryId":"30ea0479-5164-4b98-9e5d-16a72ded9c26","queryName":"_folder_M_teadus_KPI_csv"},"_folder_M_teadus_KPI_researchers":{"queryId":"13d416c4-e4af-4749-aba3-8c51939adb5b","queryName":"_folder_M_teadus_KPI_researchers"},"_testPubMaj":{"queryId":"340422f7-a991-47e2-b329-c09bddc43630","queryName":"_testPubMaj","queryGroupId":"5c250137-c863-4bf0-9e0d-202f5fbcf206"},"Query":{"queryId":"5a8ccb16-a262-497c-b52f-1752a248f11b","queryName":"Query","queryGroupId":"7091f921-f226-4d8f-8015-dc1493f32fb6"},"TargetFolderPath":{"queryId":"4a1042e5-14ae-4089-8cdc-15006c44a674","queryName":"TargetFolderPath","queryGroupId":"7091f921-f226-4d8f-8015-dc1493f32fb6"},"RootPath":{"queryId":"1c684588-cc09-4366-b1df-a1840eb0eca8","queryName":"RootPath","queryGroupId":"7091f921-f226-4d8f-8015-dc1493f32fb6"},"_testPubInstituut":{"queryId":"8e178c26-153b-48bf-89b8-50ff45ad5287","queryName":"_testPubInstituut","queryGroupId":"dc5c3fd1-2a2a-4e25-b859-894278cf816f"},"_selectMajColheaders":{"queryId":"e0852f7d-7369-4c6d-a819-7d4c24798965","queryName":"_selectMajColheaders"},"_selectInstituutColheaders":{"queryId":"ae66c635-bcd2-4264-aff2-b75920e07b78","queryName":"_selectInstituutColheaders"},"_SciVal_SNIP_instituut201819":{"queryId":"3a1a06cd-ca3d-44a7-8a0b-cc9517419bd8","queryName":"_SciVal_SNIP_instituut201819"},"fn_extractInstituutcsv":{"queryId":"b0f2da93-e6d6-493a-83c6-ec177d71fbe1","queryName":"fn_extractInstituutcsv","queryGroupId":"dc5c3fd1-2a2a-4e25-b859-894278cf816f"},"fakt_MAJpub":{"queryId":"955284c9-163a-4495-9385-8c9a25ea1beb","queryName":"fakt_MAJpub","loadEnabled":true},"dim_MAJpub_authorID_EID":{"queryId":"e828a42b-0776-40a5-97e8-9056d06a6cce","queryName":"dim_MAJpub_authorID_EID"},"fakt_instituutpub":{"queryId":"4e661961-5544-4b09-a1aa-d61305ce2f86","queryName":"fakt_instituutpub"},"fakt_pub_M_autor":{"queryId":"1173bc47-18aa-45ae-8479-289cafd8a685","queryName":"fakt_pub_M_autor"},"lookup_ScopusEID_AuthorID":{"queryId":"3b7b55de-1666-429e-930d-2691f295ae6a","queryName":"lookup_ScopusEID_AuthorID"},"_test_extractResearchers":{"queryId":"0726bf6c-48a0-4e6a-b01e-3ad54a4f0613","queryName":"_test_extractResearchers","queryGroupId":"b13b4e57-caeb-4b8e-bd3a-c30d077140bb"},"dim_SciVal_inst_researchers":{"queryId":"6441d032-e814-46b3-bc7b-16f46309f543","queryName":"dim_SciVal_inst_researchers","queryGroupId":"b13b4e57-caeb-4b8e-bd3a-c30d077140bb"},"fn_extractResearchers":{"queryId":"0eed9044-3121-4f2a-b343-52d7bda7d1b8","queryName":"fn_extractResearchers","queryGroupId":"b13b4e57-caeb-4b8e-bd3a-c30d077140bb"},"_SciVal_majresearchers":{"queryId":"ae2ca839-a0a7-4075-b8e0-d37ffaef00d3","queryName":"_SciVal_majresearchers","queryGroupId":"b13b4e57-caeb-4b8e-bd3a-c30d077140bb"},"lookup_MAJpub_EID_autorid":{"queryId":"87e8fb16-66f2-4022-b306-e3aa9188e0bb","queryName":"lookup_MAJpub_EID_autorid"},"_testPubMaj_colHeaders":{"queryId":"32362518-e454-45d6-bb66-44a096b9bdbc","queryName":"_testPubMaj_colHeaders","queryGroupId":"5c250137-c863-4bf0-9e0d-202f5fbcf206"}},"document":"section Section1;\r\nshared fn_extractMAJcsv = let\r\n  fn_extractMAJcsv = (input as binary) =>\nlet\n  Source = input,\n  importCsv= Csv.Document(Source,[Delimiter=\",\", Columns=66, Encoding=65001, QuoteStyle=QuoteStyle.None]),\n  rangeStart = List.PositionOf( importCsv[Column1], \"Title\"),\n  lastrowposition = List.PositionOf(importCsv[Column1], \"© 2025 Elsevier B.V. All rights reserved. SciVal, RELX Group and the RE symbol are trade marks of RELX Intellectual Properties SA, used under license.\"),\n  range = lastrowposition-rangeStart-1,\n  extractRange = Table.PromoteHeaders(Table.Range(importCsv, rangeStart, range)),\n  getAasta = Text.Select( Text.BetweenDelimiters( importCsv[Column2]{0}, \"Publications in Majandusteaduskond\", \" that fall within the top\"), {\"0\"..\"9\"}),\n  selectRows = Table.SelectRows(extractRange, each if getAasta = \"2024\" then ([Year] = getAasta or [Year]=\"2025\") else [Year] = getAasta),\n  selectCols = Table.SelectColumns(selectRows, _selectMajColheaders),\n  renameSNIP = Table.RenameColumns(selectCols,{{\"SNIP percentile (publication year) *\", \"SNIP\"}}),\n  addKvartiil = Table.RemoveColumns( Table.AddColumn(renameSNIP, \"Kvartiil\", each let percentile = Number.FromText([SNIP]), result = try if percentile <= 25 then \"Q1\" else if percentile <= 50 then \"Q2\" else if percentile <= 75 then \"Q3\" else if percentile <= 100 then \"Q4\" else \"na\" otherwise \"na\" in result, type text), {\"SNIP\"})\nin\n  addKvartiil\r\nin\r\n  fn_extractMAJcsv;\r\nshared _folder_M_teadus_KPI = let\n  Source = SharePoint.Contents(\"https://livettu.sharepoint.com/sites/M_Dashboard\"),\r\n  Navigation = Source{[Name = \"Documents\"]}[Content],\r\n  #\"Navigation 1\" = Navigation{[Name = \"M_teadus\"]}[Content],\r\n  #\"Navigation 2\" = #\"Navigation 1\"{[Name = \"KPI_Q1arv_aastas_dok_JAH\"]}[Content]  \nin \n  #\"Navigation 2\";\r\nshared _folder_M_teadus_KPI_csv = let\n  Source = SharePoint.Contents(\"https://livettu.sharepoint.com/sites/M_Dashboard\"),\r\n  Navigation = Source{[Name = \"Documents\"]}[Content],\r\n  #\"Navigation 1\" = Navigation{[Name = \"M_teadus\"]}[Content],\r\n  #\"Navigation 2\" = #\"Navigation 1\"{[Name = \"KPI_Q1arv_aastas_dok_JAH\"]}[Content],\r\n  #\"Navigation 3\" = #\"Navigation 2\"{[Name = \"csv\"]}[Content]  \nin \n  #\"Navigation 3\";\r\nshared _folder_M_teadus_KPI_researchers = let\n  Source = SharePoint.Contents(\"https://livettu.sharepoint.com/sites/M_Dashboard\"),\r\n  Navigation = Source{[Name = \"Documents\"]}[Content],\r\n  #\"Navigation 1\" = Navigation{[Name = \"M_teadus\"]}[Content],\r\n  #\"Navigation 2\" = #\"Navigation 1\"{[Name = \"KPI_Q1arv_aastas_dok_JAH\"]}[Content],\r\n  #\"Navigation 3\" = #\"Navigation 2\"{[Name = \"researchers\"]}[Content]  \nin \n  #\"Navigation 3\";\r\nshared _testPubMaj = let\n  Source = _folder_M_teadus_KPI_csv,\n  Custom = Table.SelectRows(Source, each Text.StartsWith([Name], \"Publications_in_Majandusteaduskond\")),\n  getCsv = Custom[Content] {19},\n  importCsv= Csv.Document(getCsv,[Delimiter=\",\", Columns=66, Encoding=65001, QuoteStyle=QuoteStyle.None]),\n  rangeStart = List.PositionOf( importCsv[Column1], \"Title\"),\n  lastrowposition = List.PositionOf(importCsv[Column1], \"© 2025 Elsevier B.V. All rights reserved. SciVal, RELX Group and the RE symbol are trade marks of RELX Intellectual Properties SA, used under license.\"),\n  range = lastrowposition-rangeStart-1,\n  extractRange = Table.PromoteHeaders(Table.Range(importCsv, rangeStart, range)),\n  getAasta = Text.Select( Text.BetweenDelimiters( importCsv[Column2]{0}, \"Publications in Majandusteaduskond\", \" that fall within the top\"), {\"0\"..\"9\"}),\n  selectRows = Table.SelectRows(extractRange, each if getAasta = \"2024\" then ([Year] = getAasta or [Year]=\"2025\") else [Year] = getAasta),\n  selectCols = Table.SelectColumns(selectRows, _selectMajColheaders),\n  renameSNIP = Table.RenameColumns(selectCols,{{\"SNIP percentile (publication year) *\", \"SNIP\"}}),\n  addKvartiil = Table.RemoveColumns( Table.AddColumn(renameSNIP, \"Kvartiil\", each let percentile = Number.FromText([SNIP]), result = try if percentile <= 25 then \"Q1\" else if percentile <= 50 then \"Q2\" else if percentile <= 75 then \"Q3\" else if percentile <= 100 then \"Q4\" else \"na\" otherwise \"na\" in result, type text), {\"SNIP\"})\nin\n    addKvartiil;\r\nshared Query = let\n    // Ensure RootPath parameter points to: \"https://livettu.sharepoint.com/sites/M_Dashboard\"\n    // Ensure TargetFolderPath_Relative parameter points to the CORRECT relative path like:\n    // \"/sites/M_Dashboard/Shared Documents/M_teadus/KPI_Q1arv_aastas_dok_JAH/csv/\"  <-- VERIFY THIS PATH\n\n    // 1. Connect to the Site Files\n    Source =  SharePoint.Files(RootPath, [ApiVersion = 15]),\r\n  Custom = Table.SelectRows( Source, each Text.Contains([Folder Path], TargetFolderPath)),\r\n  #\"From Value\" = Table.FromValue(Custom),\r\n  #\"Remove Columns\" = Table.RemoveColumns(#\"From Value\", Table.ColumnsOfType(#\"From Value\", {type table, type record, type list, type nullable binary, type binary, type function}))\n\n\nin\n    #\"Remove Columns\";\r\nshared TargetFolderPath = let\r\n  TargetFolderPath = \"https://livettu.sharepoint.com/sites/M_Dashboard/Shared Documents/M_teadus/KPI_Q1arv_aastas_dok_JAH/csv\" meta [IsParameterQuery = true, IsParameterQueryRequired = false, Type = type text]\r\nin\r\n  TargetFolderPath;\r\nshared RootPath = let\r\n  RootPath = \"https://livettu.sharepoint.com/sites/M_Dashboard\" meta [IsParameterQuery = true, IsParameterQueryRequired = false, Type = type any]\r\nin\r\n  RootPath;\r\nshared _testPubInstituut = let\n  Source = _folder_M_teadus_KPI_csv,\n  selectInstituut = Table.SelectRows(Source, each Text.StartsWith([Name], \"Publications_in\") and not Text.Contains([Name], \"Majandusteaduskond\") and not Text.Contains([Name], \"SNIP_instituut201819\")),\n  selectCsv = selectInstituut[Content] {13},    \n  importCsv= Csv.Document(selectCsv,[Delimiter=\",\", Columns=66, Encoding=65001, QuoteStyle=QuoteStyle.None]),\n  rangeStart = List.PositionOf( importCsv[Column1], \"Title\"),\n  lastrowposition = List.PositionOf(importCsv[Column1], \"© 2025 Elsevier B.V. All rights reserved. SciVal, RELX Group and the RE symbol are trade marks of RELX Intellectual Properties SA, used under license.\"),\n  range = lastrowposition-rangeStart-1,\n  getInstituut = Text.BetweenDelimiters(importCsv[Column2]{0}, \"Publications in \", \"that fall within the top\"),\n  extract = let extract = Text.AfterDelimiter(importCsv[Column2]{0}, \"Publications in \"), top = Text.BeforeDelimiter( Text.BetweenDelimiters(extract, \"that fall within the \", \"-\"), \"%\"), publication = Text.BeforeDelimiter(importCsv[Column1]{13}, \" publications\"), result = getInstituut & top & \" \" & publication in result,\n  getAasta = let  list1 = List.Buffer(_SciVal_SNIP_instituut201819[aasta]), list0 = List.Buffer(_SciVal_SNIP_instituut201819[key]), aasta = Text.Select( Text.BetweenDelimiters( importCsv[Column2]{0}, \"Publications in\", \" that fall within the top\"), {\"0\"..\"9\"}), listresult = list1{List.PositionOf(list0, extract)}, result = if  aasta =\"\" then listresult else aasta in result,\n  extractRange = Table.PromoteHeaders(Table.Range(importCsv, rangeStart, range)),\n    selectRows = Table.SelectRows(extractRange, each if getAasta = \"2024\" then ([Year] = getAasta or [Year]=\"2025\") else [Year] = getAasta),\n  selectCols = Table.SelectColumns(selectRows, _selectInstituutColheaders),\n  addInstituut = Table.AddColumn(selectCols, \"instituut\", each let _value = Text.Start(getInstituut,1), result = if _value = \"Ä\" then \"MM\" else if _value = \"M\" then \"ME\" else if _value = \"Õ\" then \"MO\" else if _value = \"R\" then \"MN\" else \"na\" in result, type text),\n  renameSNIP = Table.RenameColumns(addInstituut,{{\"SNIP percentile (publication year) *\", \"SNIP\"}}),\n  addKvartiil = Table.RemoveColumns( Table.AddColumn(renameSNIP, \"Kvartiil\", each let percentile = Number.FromText([SNIP]), result = try if percentile <= 25 then \"Q1\" else if percentile <= 50 then \"Q2\" else if percentile <= 75 then \"Q3\" else if percentile <= 100 then \"Q4\" else \"na\" otherwise \"na\" in result, type text), {\"SNIP\"})\nin\n  addKvartiil;\r\nshared _selectMajColheaders = let\n    Source =  {\"Year\", \"Title\", \"Scopus Source title\", \"Source type\", \"SNIP percentile (publication year) *\", \"Scopus Author Ids\", \"EID\"}\r\n//note on 17.04.2025 no need to keep so many cols { \"Year\", \"Title\", \"Scopus Source title\", \"ISSN\", \"DOI\", \"Source ID\", \"Source type\", \"Abstract\",\"SNIP (publication year)\", \"SNIP percentile (publication year) *\", \"Authors\", \"Scopus Author Ids\", \"Topic Cluster name\", \"Topic name\", \"Sustainable Development Goals (2023)\", \"EID\"}\r\n\r\n\nin\n    Source;\r\nshared _selectInstituutColheaders = let\n    Source =   { \"Year\", \"Title\",  \"Scopus Source title\", \"Source type\", \"SNIP percentile (publication year) *\", \"Authors\", \"Scopus Author Ids\", \"EID\"}\r\n//note on 17.04.2025 no need to keep so many cols { \"Year\", \"Title\", \"Scopus Source title\", \"ISSN\", \"DOI\", \"Source ID\", \"Source type\", \"Abstract\",\"SNIP (publication year)\", \"SNIP percentile (publication year) *\", \"Authors\", \"Scopus Author Ids\", \"Topic Cluster name\", \"Topic name\", \"Sustainable Development Goals (2023)\", \"EID\"}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\nin\n    Source;\r\nshared _SciVal_SNIP_instituut201819 = let\n  Source = _folder_M_teadus_KPI_csv,\n  selectInstituut = Table.SelectRows(Source, each Text.Contains([Name], \"SNIP_instituut201819\"))[Content]{0},    \n  importCsv= Csv.Document(selectInstituut,[Delimiter=\",\", Columns=2, Encoding=65001, QuoteStyle=QuoteStyle.None]),\r\n  #\"Added index\" = Table.AddIndexColumn(importCsv, \"Index\", 1, 1, Int64.Type),\r\n  #\"Inserted modulo\" = Table.AddColumn(#\"Added index\", \"Modulo\", each Number.Mod([Index], 24), Int64.Type),\r\n  addAasta = Table.AddColumn(#\"Inserted modulo\", \"aasta\", each let _value =([Index]-1) / 24, result = if Number.IsOdd(_value) then \"2019\" else \"2018\" in result, type text),\r\n  addInstituut = Table.AddColumn(addAasta, \"instituut\", each if [Modulo] = 2 then [Column2] else null,  type text),\r\n  filterModulo = Table.FillDown(Table.SelectRows(addInstituut, each ([Modulo] = 2 or [Modulo] = 15 or [Modulo] = 16 or [Modulo] = 17 or [Modulo] = 18)), {\"instituut\"}),\r\n  #\"Filtered rows 1\" = Table.SelectRows(filterModulo, each ([Modulo] <> 2)),\r\n  #\"Removed columns\" = Table.RemoveColumns(#\"Filtered rows 1\", {\"Index\", \"Modulo\"}),\r\n  #\"Trimmed text\" = Table.TransformColumns(#\"Removed columns\", {\r\n    {\"Column1\", each Text.Start( Text.BetweenDelimiters(_, \"(\", \")\"), 6), type text}, \r\n    {\"Column2\", each Text.BeforeDelimiter(_, \".0\"), type text}\r\n    }),\r\n  Custom = Table.CombineColumns(#\"Trimmed text\", {\"instituut\", \"Column1\", \"Column2\"},\r\n    Combiner.CombineTextByDelimiter(\" \", QuoteStyle.None),\r\n    \"key\"\r\n)\nin\n    Custom;\r\nshared fn_extractInstituutcsv = let\r\n  fn_extractInstituutcsv = (content as binary) => \nlet\n  Source = content, \n  importCsv= Csv.Document(Source,[Delimiter=\",\", Columns=66, Encoding=65001, QuoteStyle=QuoteStyle.None]),\n  rangeStart = List.PositionOf( importCsv[Column1], \"Title\"),\n  lastrowposition = List.PositionOf(importCsv[Column1], \"© 2025 Elsevier B.V. All rights reserved. SciVal, RELX Group and the RE symbol are trade marks of RELX Intellectual Properties SA, used under license.\"),\n  range = lastrowposition-rangeStart-1,\n  getInstituut = Text.BetweenDelimiters(importCsv[Column2]{0}, \"Publications in \", \"that fall within the top\"),\n  extract = let extract = Text.AfterDelimiter(importCsv[Column2]{0}, \"Publications in \"), top = Text.BeforeDelimiter( Text.BetweenDelimiters(extract, \"that fall within the \", \"-\"), \"%\"), publication = Text.BeforeDelimiter(importCsv[Column1]{13}, \" publications\"), result = getInstituut & top & \" \" & publication in result,\n  getAasta = let  list1 = List.Buffer(_SciVal_SNIP_instituut201819[aasta]), list0 = List.Buffer(_SciVal_SNIP_instituut201819[key]), aasta = Text.Select( Text.BetweenDelimiters( importCsv[Column2]{0}, \"Publications in\", \" that fall within the top\"), {\"0\"..\"9\"}), listresult = list1{List.PositionOf(list0, extract)}, result = if  aasta =\"\" then listresult else aasta in result,\n  extractRange = Table.PromoteHeaders(Table.Range(importCsv, rangeStart, range)),\n    selectRows = Table.SelectRows(extractRange, each if getAasta = \"2024\" then ([Year] = getAasta or [Year]=\"2025\") else [Year] = getAasta),\n  selectCols = Table.SelectColumns(selectRows, _selectInstituutColheaders),\n  addInstituut = Table.AddColumn(selectCols, \"instituut\", each let _value = Text.Start(getInstituut,1), result = if _value = \"Ä\" then \"MM\" else if _value = \"M\" then \"ME\" else if _value = \"Õ\" then \"MO\" else if _value = \"R\" then \"MN\" else \"na\" in result, type text),\n  renameSNIP = Table.RenameColumns(addInstituut,{{\"SNIP percentile (publication year) *\", \"SNIP\"}}),\n  addKvartiil = Table.RemoveColumns( Table.AddColumn(renameSNIP, \"Kvartiil\", each let percentile = Number.FromText([SNIP]), result = try if percentile <= 25 then \"Q1\" else if percentile <= 50 then \"Q2\" else if percentile <= 75 then \"Q3\" else if percentile <= 100 then \"Q4\" else \"na\" otherwise \"na\" in result, type text), {\"SNIP\"})\nin\n  addKvartiil\r\nin\r\n  fn_extractInstituutcsv;\r\nshared fakt_MAJpub = let\n  Source = _folder_M_teadus_KPI_csv,\n  Custom = Table.SelectRows(Source, each Text.StartsWith([Name], \"Publications_in_Majandusteaduskond\")),\n  #\"Added custom\" = Table.AddColumn(Custom, \"Custom\", each fn_extractMAJcsv([Content])),\n  #\"Custom 1\" = Table.Distinct(Table.Combine( #\"Added custom\"[Custom])),\n  #\"Split column by delimiter\" = Table.ExpandListColumn(Table.TransformColumns(#\"Custom 1\", {{\"Scopus Author Ids\", Splitter.SplitTextByDelimiter(\"| \"), let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), \"Scopus Author Ids\"),\n  #\"Merged queries\" = Table.NestedJoin(#\"Split column by delimiter\", {\"Scopus Author Ids\"}, dim_SciVal_inst_researchers, {\"Scopus Author ID\"}, \"dim_SciVal_inst_researchers\", JoinKind.LeftOuter),\n  #\"Expanded dim_SciVal_inst_researchers\" = Table.ExpandTableColumn(#\"Merged queries\", \"dim_SciVal_inst_researchers\", {\"Author\", \"instituut\"}, {\"autor\", \"instituut\"}),\n  #\"Filtered rows\" = Table.SelectRows(#\"Expanded dim_SciVal_inst_researchers\", each ([instituut] <> null))\nin\n  #\"Filtered rows\";\r\nshared dim_MAJpub_authorID_EID = let\r\n  Source = fakt_MAJpub,\r\n  #\"Removed other columns\" = Table.SelectColumns(Source, {\"EID\", \"Scopus Author Ids\"}),\r\n  #\"Split column by delimiter\" = Table.ExpandListColumn(Table.TransformColumns(#\"Removed other columns\", {{\"Scopus Author Ids\", Splitter.SplitTextByDelimiter(\"| \"), let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), \"Scopus Author Ids\")\r\nin\r\n  #\"Split column by delimiter\";\r\nshared fakt_instituutpub = let\n  Source = _folder_M_teadus_KPI_csv,\r\n  Custom = Table.SelectRows(Source, each Text.StartsWith([Name], \"Publications_in_\") and not Text.StartsWith([Name], \"Publications_in_Majandusteaduskond\")),\r\n  #\"Custom 1\" = Table.AddColumn(Custom, \"custom\", each fn_extractInstituutcsv([Content])),\r\n  #\"Custom 2\" = Table.Distinct( Table.Combine(#\"Custom 1\"[custom]))\nin\n  #\"Custom 2\";\r\nshared fakt_pub_M_autor = let\r\n  Source = fakt_instituutpub\r\nin\r\n  Source;\r\nshared lookup_ScopusEID_AuthorID = let\r\n  Source = fakt_instituutpub,\r\n  #\"Removed other columns\" = Table.SelectColumns(Source, {\"instituut\", \"EID\", \"Scopus Author Ids\", \"Authors\"}),\r\n  #\"Added custom\" = Table.TransformColumns(#\"Removed other columns\", {{\"Scopus Author Ids\", each Text.Split(_, \"| \"), type list}, {\"Authors\", each Text.Split(_, \"| \"), type list}}),\r\n  #\"Added custom 1\" = Table.AddColumn(#\"Added custom\", \"Custom\", each List.Zip({[Scopus Author Ids], [Authors]})),\r\n  #\"Removed columns\" = Table.RemoveColumns(#\"Added custom 1\", {\"Authors\", \"Scopus Author Ids\"}),\r\n  #\"Expanded Custom\" = Table.ExpandListColumn(#\"Removed columns\", \"Custom\"),\r\n  Custom = Table.TransformColumns(#\"Expanded Custom\", {\"Custom\", each Text.Combine(List.Transform(_, Text.From), \"|\"), type text}),\r\n  #\"Split column by delimiter\" = Table.SplitColumn(Custom, \"Custom\", Splitter.SplitTextByDelimiter(\"|\"), {\"authorID\", \"author\"})\r\nin\r\n  #\"Split column by delimiter\";\r\nshared _test_extractResearchers = let\r\n  Source = _folder_M_teadus_KPI_researchers,\r\n  Custom = Source[Content] {3},\r\n  #\"Custom 1\" = Table.PromoteHeaders(Csv.Document(Custom, [Columns=6, Delimiter=\",\", Encoding =65001])),\r\n  addAasta = Table.AddColumn(#\"Custom 1\", \"aasta\", each Text.End([Level 1], 4), type text),\r\n  addInstituut = Table.AddColumn(addAasta, \"instituut\", each let _value = Text.Start([Level 2],1), result = if _value = \"Ä\" then \"MM\" else if _value = \"M\" then \"ME\" else if _value = \"Õ\" then \"MO\" else if _value = \"R\" then \"MN\" else \"MAJ\" in result, type text),\r\n  removeCols = Table.RemoveColumns(addInstituut, {\"Tags\", \"Level 1\", \"Level 2\"})\r\nin\r\n  removeCols;\r\nshared dim_SciVal_inst_researchers = let\r\n  Source = _SciVal_majresearchers,\r\n  #\"Grouped rows\" = Table.Group(Source, {\"Scopus Author ID\", \"Author\"}, {{\"instituut\", each Table.Sort(_, {\"aasta\", Order.Descending})[instituut]{0}, type text}})\r\nin\r\n  #\"Grouped rows\";\r\nshared fn_extractResearchers = let\r\n  fn_extractResearchers = (content as binary) =>\nlet\n  Source = content,\n  importCsv = Table.PromoteHeaders(Csv.Document(Source, [Columns=6, Delimiter=\",\", Encoding =65001])),\n  addAasta = Table.AddColumn(importCsv, \"aasta\", each Text.End([Level 1], 4), type text),\n  addInstituut = Table.AddColumn(addAasta, \"instituut\", each let _value = Text.Start([Level 2],1), result = if _value = \"Ä\" then \"MM\" else if _value = \"M\" then \"ME\" else if _value = \"Õ\" then \"MO\" else if _value = \"R\" then \"MN\" else \"dekanaat\" in result, type text),\n  removeCols = Table.RemoveColumns(addInstituut, {\"Tags\", \"Level 1\", \"Level 2\"})\nin\n  removeCols\r\nin\r\n  fn_extractResearchers;\r\nshared _SciVal_majresearchers = let\r\n  Source = _folder_M_teadus_KPI_researchers,\r\n  #\"Added custom\" = Table.AddColumn(Source, \"Custom\", each fn_extractResearchers([Content])),\r\n  Custom = Table.Combine(#\"Added custom\"[Custom])\r\nin\r\n  Custom;\r\nshared lookup_MAJpub_EID_autorid = let\n  Source = fakt_MAJpub,\n  #\"Removed other columns\" = Table.SelectColumns(Source, {\"EID\", \"Scopus Author Ids\", \"Kvartiil\", \"Year\"}),\n  #\"Split column by delimiter\" = Table.ExpandListColumn(Table.TransformColumns(#\"Removed other columns\", {{\"Scopus Author Ids\", Splitter.SplitTextByDelimiter(\"| \"), let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), \"Scopus Author Ids\"),\r\n  #\"Merged queries\" = Table.NestedJoin(#\"Split column by delimiter\", {\"Scopus Author Ids\"}, dim_SciVal_inst_researchers, {\"Scopus Author ID\"}, \"dim_SciVal_inst_researchers\", JoinKind.LeftOuter),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Merged queries\", {{\"EID\", type text}, {\"Scopus Author Ids\", Int64.Type}, {\"Year\", Int64.Type}}),\r\n  #\"Expanded dim_SciVal_inst_researchers\" = Table.ExpandTableColumn(#\"Changed column type\", \"dim_SciVal_inst_researchers\", {\"instituut\"}, {\"instituut\"}),\r\n  #\"Filtered rows\" = Table.SelectRows(#\"Expanded dim_SciVal_inst_researchers\", each ([instituut] <> null))\nin\n  #\"Filtered rows\";\r\nshared _testPubMaj_colHeaders = let\n  Source = _folder_M_teadus_KPI_csv,\n  Custom = Table.SelectRows(Source, each Text.StartsWith([Name], \"Publications_in_Majandusteaduskond\")),\n  getCsv = Custom[Content] {19},\n  importCsv= Csv.Document(getCsv,[Delimiter=\",\", Columns=66, Encoding=65001, QuoteStyle=QuoteStyle.None]),\n  rangeStart = List.PositionOf( importCsv[Column1], \"Title\"),\n  lastrowposition = List.PositionOf(importCsv[Column1], \"© 2025 Elsevier B.V. All rights reserved. SciVal, RELX Group and the RE symbol are trade marks of RELX Intellectual Properties SA, used under license.\"),\n  range = lastrowposition-rangeStart-1,\n  extractRange = Table.PromoteHeaders(Table.Range(importCsv, rangeStart, range)),\r\n  #\"Custom 1\" = Table.ColumnNames(extractRange),\r\n  #\"Converted to table\" = Table.FromList(#\"Custom 1\", Splitter.SplitByNothing(), {\"SciVal field\"}, null, ExtraValues.Error)\nin\n    #\"Converted to table\";\r\n","connectionOverrides":[{"path":"https://livettu.sharepoint.com/","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://livettu.sharepoint.com/\"}","audience":null},{"path":"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee/","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee/\"}","audience":null},{"path":"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee/Documents/Apps/Microsoft Power Query/Uploaded Files/Publications_in_Majandusteaduskond_2021_that_fall_within_the_top_25%_journals_by_SNIP_2018_to_2024.csv","kind":"Web","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Web\",\"path\":\"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee/Documents/Apps/Microsoft Power Query/Uploaded Files/Publications_in_Majandusteaduskond_2021_that_fall_within_the_top_25%_journals_by_SNIP_2018_to_2024.csv\"}","audience":null},{"path":"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee\"}","audience":null}]},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"Id\":\"7091f921-f226-4d8f-8015-dc1493f32fb6\",\"Name\":\"SharePoint.Files\",\"Description\":\"An alternative to SharePoint.Contents\",\"ParentId\":null,\"Order\":0},{\"Id\":\"dc5c3fd1-2a2a-4e25-b859-894278cf816f\",\"Name\":\"fn_extractInstituutcsv\",\"Description\":null,\"ParentId\":null,\"Order\":2},{\"Id\":\"5c250137-c863-4bf0-9e0d-202f5fbcf206\",\"Name\":\"fn_extractMAJcsv\",\"Description\":\"\",\"ParentId\":null,\"Order\":3},{\"Id\":\"b13b4e57-caeb-4b8e-bd3a-c30d077140bb\",\"Name\":\"SciVal_MAJ_researchers\",\"Description\":\"\",\"ParentId\":null,\"Order\":1}]"}],"entities":[{"$type":"LocalEntity","name":"fakt_MAJpub","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"fakt_MAJpub.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"Year","dataType":"string"},{"name":"Title","dataType":"string"},{"name":"Scopus Source title","dataType":"string"},{"name":"Source type","dataType":"string"},{"name":"Scopus Author Ids","dataType":"string"},{"name":"EID","dataType":"string"},{"name":"Kvartiil","dataType":"string"},{"name":"autor","dataType":"string"},{"name":"instituut","dataType":"string"}]}]}