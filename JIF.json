{"name":"JIF","version":"1.0","culture":"en-US","modifiedTime":"2025-05-06T13:25:15.6665711+00:00","ppdf:outputFileFormat":"parquet","ppdf:dataflowId":"f4018948-7ebd-47fa-ae2d-38334b0a823d","ppdf:owner":{"tenantId":"3efd4d88-9b88-4fc9-b6c0-c7ca50f1db57","userId":"84427c2b-9e9c-4069-a4ef-32e34b3e92fb"},"ppdf:fastCopy":true,"pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"_folderMteadus":{"queryId":"02413a92-793a-459e-b22e-737b6704d76a","queryName":"_folderMteadus","queryGroupId":"d1c16c99-a978-45cb-9526-a1ed40851ee7"},"_ClarivateJournalCitationReportsCategoryGroups":{"queryId":"80e5eb9e-ba87-4f80-9452-e75cee8fc3b8","queryName":"_ClarivateJournalCitationReportsCategoryGroups","queryGroupId":"d1c16c99-a978-45cb-9526-a1ed40851ee7"},"JIFfunctionTest":{"queryId":"4ad5b7d6-59b6-4dbf-b0bd-c22a1cd5f559","queryName":"JIFfunctionTest","queryGroupId":"d1c16c99-a978-45cb-9526-a1ed40851ee7"},"fn_getCsv":{"queryId":"0ace27cf-41e6-4188-89de-b2f429e652f4","queryName":"fn_getCsv","queryGroupId":"d1c16c99-a978-45cb-9526-a1ed40851ee7"},"_folder_T_Tunnustamine":{"queryId":"9150d3fd-8024-4bea-bc34-ce356c70d793","queryName":"_folder_T_Tunnustamine","queryGroupId":"d1c16c99-a978-45cb-9526-a1ed40851ee7"},"_folder_Teadusartikkel":{"queryId":"582428c3-4095-48b2-a13d-2e339a519e0f","queryName":"_folder_Teadusartikkel","queryGroupId":"d1c16c99-a978-45cb-9526-a1ed40851ee7"},"_pubColNames":{"queryId":"46866fa0-5de8-406d-8ece-02502a16261b","queryName":"_pubColNames","queryGroupId":"d1c16c99-a978-45cb-9526-a1ed40851ee7"},"tuumik":{"queryId":"ef746e87-2c30-4e4b-8683-fb26c494cece","queryName":"tuumik","queryGroupId":"d1c16c99-a978-45cb-9526-a1ed40851ee7"},"_getExcel":{"queryId":"0c0555f3-f4c3-43d8-8a01-4de652374ac7","queryName":"_getExcel","queryGroupId":"d1c16c99-a978-45cb-9526-a1ed40851ee7"},"JIF2021":{"queryId":"d6d88027-3fbe-42ba-8c51-facd406a8033","queryName":"JIF2021","queryGroupId":"67d2c918-31df-4059-a0b0-49ec9e21bf07","loadEnabled":true},"JIF2022":{"queryId":"decc80db-3d75-43e4-97c5-244821c8e405","queryName":"JIF2022","queryGroupId":"67d2c918-31df-4059-a0b0-49ec9e21bf07","loadEnabled":true},"JIF2023":{"queryId":"53d7338a-fcab-4f80-b11d-4a7fec297f7d","queryName":"JIF2023","queryGroupId":"67d2c918-31df-4059-a0b0-49ec9e21bf07","loadEnabled":true},"_lookupMDPI":{"queryId":"3797b1b2-a7de-4b5a-aaae-2504ba2e6227","queryName":"_lookupMDPI"},"JIF_alates2021":{"queryId":"1110d273-321d-4727-bdb5-673c7ee0f964","queryName":"JIF_alates2021","loadEnabled":true},"publication":{"queryId":"438b788c-e8ad-49e6-8d48-f10ad9969cd5","queryName":"publication"},"dataCustomISSN":{"queryId":"d225698f-1557-47bb-9dfb-62ab43a64732","queryName":"dataCustomISSN","loadEnabled":true}},"document":"section Section1;\r\nshared _folderMteadus = let\n  Source = SharePoint.Contents(\"https://livettu.sharepoint.com/sites/M_Dashboard\"),\n  folderDocumsnts = Source{[Name = \"Documents\"]}[Content],\n  folderM_teadus = folderDocumsnts{[Name = \"M_teadus\"]}[Content]\nin\n  folderM_teadus;\r\nshared _ClarivateJournalCitationReportsCategoryGroups = let\n  Source = _folderMteadus,\n  Navigation = Source{[Name = \"ClarivateJournalCitationReportsCategoryGroups\"]}[Content]\nin\n  Navigation;\r\nshared JIFfunctionTest = let\n  Source = _ClarivateJournalCitationReportsCategoryGroups,\n  selectYear= Source{[Name = \"2023\"]}[Content],\n  selectRow = selectYear{28}[Content],\n  getCsv = Csv.Document(selectRow, [Delimiter = \",\", Columns = 12, QuoteStyle = QuoteStyle.None]),\n  getAasta = Number.From(Text.BetweenDelimiters(getCsv[Column1]{0},\"Year: \", \" Selected Category Schema\")),\n  position = List.PositionOf( Table.AddColumn( getCsv, \"custom\", each Text.StartsWith([Column1], \"Copyright\"))[custom], true),\n  removeCol = Table.RemoveColumns(getCsv, {\"Column3\", \"Column7\", \"Column8\", \"Column10\"}),\n  getRange = Table.PromoteHeaders(Table.Range(removeCol,2, position-3)),\n  getColNames = Table.ColumnNames(getRange),\n  renameCols = Table.RenameColumns(getRange, {{getColNames{5}, \"JIF\"}, {getColNames{6}, \"JIF5y\"}, {getColNames{7}, \"JIF5yQ\"}}),\n  replaceNA = Table.ReplaceValue( \n    Table.ReplaceValue(renameCols,\"N/A\", null,Replacer.ReplaceValue,{\"JIF\", \"JIF5y\"}), \n    \"<0.1\", 0.09, Replacer.ReplaceValue,{\"JIF\", \"JIF5y\"}),\n  #\"Extracted last characters\" = Table.TransformColumns(replaceNA, {{\"JIF5yQ\", each try Number.From(Text.Select(_, {\"0\"..\"9\"})) otherwise null, Int64.Type}}),\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Extracted last characters\", {{\"JIF\", type number}, {\"JIF5y\", type number}}),\n  addAasta = Table.TransformColumnTypes(Table.AddColumn(#\"Changed column type\", \"aasta\", each getAasta), {{\"aasta\", Int64.Type}})\nin\n    addAasta;\r\nshared fn_getCsv = let\r\n  fn_getCsv = (input as binary) as table =>\n    let\n    getCsv = Csv.Document(input, [Delimiter = \",\", Columns = 12, QuoteStyle = QuoteStyle.None]),\n    getAasta = Number.From(Text.BetweenDelimiters(getCsv[Column1]{0},\"Year: \", \" Selected Category Schema\")),\n    position = List.PositionOf( Table.AddColumn(getCsv, \"custom\", each Text.StartsWith([Column1], \"Copyright\"))[custom], true),\n    removeCol = if getAasta >= 2023 then Table.RemoveColumns(getCsv, {\"Column3\", \"Column7\", \"Column8\", \"Column10\"}) else Table.RemoveColumns(getCsv, {\"Column6\", \"Column8\", \"Column11\", \"Column12\"}),\n    getRange = Table.PromoteHeaders(Table.Range(removeCol,2, position-3)),\n    getColNames = Table.ColumnNames(getRange),\n    renameCols = Table.RenameColumns(getRange, {{getColNames{5}, \"JIF\"}, {getColNames{6}, \"JIF5y\"}, {getColNames{7}, \"JIF5yQ\"}}),\n    replaceNA = Table.ReplaceValue( \n        Table.ReplaceValue(renameCols,\"N/A\", null,Replacer.ReplaceValue,{\"JIF\", \"JIF5y\"}), \n        \"<0.1\", 0.09, Replacer.ReplaceValue,{\"JIF\", \"JIF5y\"}),\n    #\"Extracted last characters\" = Table.TransformColumns(replaceNA, {{\"JIF5yQ\", each try Number.From(Text.Select(_, {\"0\"..\"9\"})) otherwise null, Int64.Type}}),\n    #\"Changed column type\" = Table.TransformColumnTypes(#\"Extracted last characters\", {{\"JIF\", type number}, {\"JIF5y\", type number}}),\n    addAasta = Table.TransformColumnTypes(Table.AddColumn(#\"Changed column type\", \"aasta\", each getAasta), {{\"aasta\", Int64.Type}})\nin\n    addAasta\r\nin\r\n  fn_getCsv;\r\nshared _folder_T_Tunnustamine = let\n  Source = SharePoint.Contents(\"https://livettu.sharepoint.com/sites/M_admin\"),\n  folderDocumsnts = Source{[Name = \"Documents\"]}[Content],\n  folderT_Tunnustamine = folderDocumsnts{[Name = \"T_Tunnustamine\"]}[Content]\nin\n  folderT_Tunnustamine;\r\nshared _folder_Teadusartikkel = let\n  Source = _folder_T_Tunnustamine,\n  Navigation = Source{[Name = \"2024 valimised\"]}[Content],\n  #\"Navigation 1\" = Navigation{[Name = \"Teadusartikkel 2024\"]}[Content],\n  #\"From Value\" = Table.FromValue(#\"Navigation 1\"),\n  #\"Remove Columns\" = Table.RemoveColumns(#\"From Value\", Table.ColumnsOfType(#\"From Value\", {type table, type record, type list, type nullable binary, type binary, type function}))\nin\n  #\"Remove Columns\";\r\nshared _pubColNames = let\n  Source = _getExcel,\n  getList = Source{[Item = \"list\", Kind = \"DefinedName\"]}[Data],\n  // delete ERS teema\n  getRange = Table.Range( getList, 0,9),\n  Custom = getRange[Column1]\nin\n  Custom;\r\nshared tuumik = let\n  Source = _getExcel,\n  getTuumik = Source {[Item = \"tummik\", Kind = \"DefinedName\"]}[Data],\n  changeColType = Table.TransformColumnTypes(getTuumik, {{\"Column1\", type text}})\nin\n  changeColType;\r\nshared _getExcel = let\n  Source = _folder_Teadusartikkel,\n  Navigation = Source{[Name = \"ETIS_1.1_2023_24_koond.xlsx\"]}[Content],\n  #\"Imported Excel workbook\" = Excel.Workbook(Navigation, null, true)\nin\n  #\"Imported Excel workbook\";\r\nshared JIF2021 = let\n  Source = _ClarivateJournalCitationReportsCategoryGroups,\n  Navigation = Source{[Name = \"2021\"]}[Content],\n  #\"Added custom\" = Table.AddColumn(Navigation, \"impact\", each Text.EndsWith(Csv.Document([Content], [Delimiter = \",\", Columns = 14, QuoteStyle = QuoteStyle.None])[Column1]{0},\"Impact\"), type logical),\n  // Ensure fnGetCsv23 is optimized or avoided\n  addCustom = Table.AddColumn(\n    #\"Added custom\", \n    \"custom\", \n    each try fn_getCsv([Content]) otherwise null, \n    type table\n  ),\n  // can't avoid unnecessary intermediate steps\n  selectCustom = Table.SelectColumns(addCustom, {\"custom\"}),\n  Custom = Table.Combine(selectCustom[custom])\nin\n  Custom;\r\nshared JIF2022 = let\n  Source = _ClarivateJournalCitationReportsCategoryGroups,\n  Navigation = Source{[Name = \"2022\"]}[Content],\n  #\"Added custom\" = Table.AddColumn(\n    Navigation, \n    \"custom\", \n    each try fn_getCsv([Content]) otherwise null, \n    type table\n  ),\n  selectCustom = Table.SelectColumns(#\"Added custom\", {\"custom\"}),\n  #\"Expanded getCsv\" = Table.Combine(selectCustom[custom])\nin\n    #\"Expanded getCsv\";\r\nshared JIF2023 = let\n  Source = _ClarivateJournalCitationReportsCategoryGroups,\n  Navigation = Source{[Name = \"2023\"]}[Content],\n  // apply custom function fn_getCsv to extract .csv file, transform and load\n  addCustom = Table.AddColumn(\n    Navigation, \n    \"custom\", \n    each try fn_getCsv([Content]) otherwise null, \n    type table\n  ),\n  // using Table.Combine for a dynamic approach\n  selectCustom = Table.SelectColumns(addCustom, {\"custom\"}),\n  Custom = Table.Distinct(Table.Combine(selectCustom[custom])),\n  #\"Added custom\" = Table.TransformColumnTypes(Table.AddColumn(Custom, \"mdpi\", each let list0 = _lookupMDPI[ISSN], result = List.PositionOf(list0, [ISSN]) in result), {{\"mdpi\", Int64.Type}})\nin\n  #\"Added custom\";\r\nshared _lookupMDPI = let\n  Source = _folder_Teadusartikkel,\n  Navigation = Source{[Name = \"https___www.mdpi.com_about_jou.csv\"]}[Content],\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 17, QuoteStyle = QuoteStyle.Csv]),\n  #\"Removed other columns\" = Table.PromoteHeaders( Table.SelectColumns(#\"Imported CSV\", {\"Column2\", \"Column4\", \"Column6\", \"Column7\", \"Column8\"})),\n  Custom =   Table.RenameColumns(#\"Removed other columns\", {{\"lean href\", \"href\"}, {\"lean\", \"journalName\"}, {\" 2\", \"ISSN\"}, {\" 3\", \"Launched\"}, {\"show-for-large-up\", \"IF\"}}),\n  #\"Trimmed text\" = Table.TransformColumns(Custom, {{\"ISSN\", each Text.Clean( Text.Trim(_)), type nullable text}, {\"journalName\", each Text.Clean( Text.Trim(_)), type nullable text}})\nin\n  #\"Trimmed text\";\r\nshared JIF_alates2021 = let\n  Source = Table.Combine({JIF2023, JIF2022, JIF2021})\nin\n  Source;\r\nshared publication = let\n    Source = _folder_Teadusartikkel,\n    getExcel = Excel.Workbook( Source {[Name=\"Publications.xlsx\"]}[Content], true, true),\n    _workSheetName_Sheet = getExcel {[Item=\"_workSheetName\",Kind=\"Sheet\"]}[Data],\n    selectCols = Table.SelectColumns(_workSheetName_Sheet,_pubColNames),\n    #\"Changed Type\" = Table.TransformColumnTypes(selectCols,{{\"Ajakiri / jätkuväljaanne\", type text}, {\"Lühikirje\", type text}, {\"Aasta\", Int64.Type}, {\"Autorid, kellel on ETISe konto\", type text}, {\"ISSN\", type text}}),\n    #\"Filtered Rows\" = Table.SelectRows(#\"Changed Type\", each ([ISSN] <> null)),\n    #\"Trimmed Text\" = Table.TransformColumns(#\"Filtered Rows\",{{\"ISSN\", Text.Trim, type text}}),\n    cleanISSN = Table.AddColumn(#\"Trimmed Text\", \"cleanISSN\", each\n    let _length = Text.Length([ISSN]), \n    _length37 = Text.Replace(Text.Replace([ISSN], \" (print)\", \"\"), \" (online)\", \"\"),\n    _length5678 = Text.Repeat(\"0\", 8-_length)& Text.Range([ISSN], 0, _length-4) & \"-\" &Text.End([ISSN],4),\n    _length18 = Text.Start([ISSN],4)&\"-\"&Text.Range([ISSN],4,4)&\"; \"&Text.Range([ISSN], 10, 4)&\"-\"&Text.End([ISSN],4), \n    _length19 = Text.Start([ISSN],9)&\"; \"&Text.End([ISSN],9),\n    _length10 = Text.Remove(Text.Remove([ISSN], \",\"), \";\"),\n    result = if _length = 9 then [ISSN] else if _length = 20 then [ISSN] else if _length <=8 then _length5678 else \n    if _length =10 then _length10 else if _length = 37 then _length37 else \n    if _length = 18 then _length18 else if _length = 19 then _length19 else \"\"  in result , type text),\n    #\"Split Column by Delimiter\" = Table.SplitColumn(cleanISSN, \"cleanISSN\", Splitter.SplitTextByDelimiter(\"; \", QuoteStyle.None), {\"cleanISSN\", \"eISSN\"}),\n    #\"Changed Type1\" = Table.TransformColumnTypes(#\"Split Column by Delimiter\", {{\"cleanISSN\", type text}, {\"eISSN\", type text}, {\"DOI\", type text}})\nin\n    #\"Changed Type1\";\r\nshared dataCustomISSN = let\n    Source = JIF2023,\n    addCustomISSN = Table.Distinct( Table.AddColumn(Source, \"customISSN\", each if [ISSN] =\"N/A\" then [eISSN] else[ISSN], type text)),\n    #\"Grouped Rows1\" = Table.Group(addCustomISSN, {\"customISSN\"}, {{\"Count\", each Table.RowCount(_), Int64.Type}, {\"table\", each _}}),\n    #\"Sorted Rows\" = Table.Sort(#\"Grouped Rows1\",{{\"Count\", Order.Descending}}),\n    Custom1 = Table.Group(addCustomISSN, {\"customISSN\", \"eISSN\"}, \n{{\"WoS Category\", each Text.Combine(List.Transform(Table.Distinct(_)[Category], Text.From), \"; \"), type text}, \n{\"JCR_abbreviation\", each Table.FirstN(Table.Sort(_, {\"JIF5y\", Order.Descending}),1)[JCR Abbreviation]{0}, type text},\n{\"journalName\", each Table.FirstN(Table.Sort(_, {\"JIF5y\", Order.Descending}),1)[Journal name]{0}, type text},\n{\"5yearJIF\", each Table.FirstN(Table.Sort(_, {\"JIF5y\", Order.Descending}),1)[JIF5y]{0}, type number},\n{\"Q1category\", each Text.Combine(List.Transform( Table.SelectRows(_, each [JIF5yQ]=1)[Category], Text.From), \" | \"), type text}})\nin\n    Custom1;\r\n","connectionOverrides":[{"path":"https://livettu.sharepoint.com/","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://livettu.sharepoint.com/\"}","audience":null}]},"annotations":[{"name":"pbi:QueryGroups","value":"[{\"Id\":\"d1c16c99-a978-45cb-9526-a1ed40851ee7\",\"Name\":\"folder_fn\",\"Description\":\"\",\"ParentId\":null,\"Order\":1},{\"Id\":\"67d2c918-31df-4059-a0b0-49ec9e21bf07\",\"Name\":\"JIF_rawdata\",\"Description\":\"\",\"ParentId\":null,\"Order\":1}]"}],"entities":[{"$type":"LocalEntity","name":"JIF2021","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"JIF2021.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"Journal name","dataType":"string"},{"name":"JCR Abbreviation","dataType":"string"},{"name":"ISSN","dataType":"string"},{"name":"eISSN","dataType":"string"},{"name":"Category","dataType":"string"},{"name":"JIF","dataType":"double"},{"name":"JIF5y","dataType":"double"},{"name":"JIF5yQ","dataType":"int64"},{"name":"aasta","dataType":"int64"}]},{"$type":"LocalEntity","name":"JIF2022","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"JIF2022.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"Journal name","dataType":"string"},{"name":"JCR Abbreviation","dataType":"string"},{"name":"ISSN","dataType":"string"},{"name":"eISSN","dataType":"string"},{"name":"Category","dataType":"string"},{"name":"JIF","dataType":"double"},{"name":"JIF5y","dataType":"double"},{"name":"JIF5yQ","dataType":"int64"},{"name":"aasta","dataType":"int64"}]},{"$type":"LocalEntity","name":"JIF2023","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"JIF2023.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[{\"columns\":[\"Journal name\",\"JCR Abbreviation\",\"ISSN\",\"eISSN\",\"Category\",\"JIF\",\"JIF5y\",\"JIF5yQ\",\"aasta\"]}]"}],"attributes":[{"name":"Journal name","dataType":"string"},{"name":"JCR Abbreviation","dataType":"string"},{"name":"ISSN","dataType":"string"},{"name":"eISSN","dataType":"string"},{"name":"Category","dataType":"string"},{"name":"JIF","dataType":"double"},{"name":"JIF5y","dataType":"double"},{"name":"JIF5yQ","dataType":"int64"},{"name":"aasta","dataType":"int64"},{"name":"mdpi","dataType":"int64"}]},{"$type":"LocalEntity","name":"JIF_alates2021","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"JIF_alates2021.parquet"},"annotations":[{"name":"pbi:EntityTypeDisplayHint","value":"CalculatedEntity"},{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"Journal name","dataType":"string"},{"name":"JCR Abbreviation","dataType":"string"},{"name":"ISSN","dataType":"string"},{"name":"eISSN","dataType":"string"},{"name":"Category","dataType":"string"},{"name":"JIF","dataType":"double"},{"name":"JIF5y","dataType":"double"},{"name":"JIF5yQ","dataType":"int64"},{"name":"aasta","dataType":"int64"},{"name":"mdpi","dataType":"int64"}]},{"$type":"LocalEntity","name":"dataCustomISSN","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"dataCustomISSN.parquet"},"annotations":[{"name":"pbi:EntityTypeDisplayHint","value":"CalculatedEntity"},{"name":"ppdf:entityKeys","value":"[{\"columns\":[\"customISSN\",\"eISSN\"]}]"}],"attributes":[{"name":"customISSN","dataType":"string"},{"name":"eISSN","dataType":"string"},{"name":"WoS Category","dataType":"string"},{"name":"JCR_abbreviation","dataType":"string"},{"name":"journalName","dataType":"string"},{"name":"5yearJIF","dataType":"double"},{"name":"Q1category","dataType":"string"}]}]}