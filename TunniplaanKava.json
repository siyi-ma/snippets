{"name":"TunniplaanKava","version":"1.0","culture":"en-US","modifiedTime":"2025-02-08T15:31:25.1605257+00:00","ppdf:outputFileFormat":"parquet","ppdf:dataflowId":"f330ee0c-b1c1-4476-84ae-728b47d2ae77","ppdf:owner":{"tenantId":"3efd4d88-9b88-4fc9-b6c0-c7ca50f1db57","userId":"84427c2b-9e9c-4069-a4ef-32e34b3e92fb"},"ppdf:fastCopy":true,"pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"_folderCourseLinks":{"queryId":"5bb27e5b-7fb3-410e-ae36-7dd076b50de1","queryName":"_folderCourseLinks"},"fnCourseLinks":{"queryId":"e4e015cf-1639-4185-a965-182c82a50696","queryName":"fnCourseLinks"},"tunniplaan_kava_ainerul":{"queryId":"b28bd445-98cc-4e75-a958-ea96fb33a425","queryName":"tunniplaan_kava_ainerul","loadEnabled":true}},"document":"section Section1;\r\nshared _folderCourseLinks = let\n    Source = SharePoint.Contents(\"https://livettu.sharepoint.com/sites/M_Dashboard\"),\n    M_õppetöö = Source{[Name=\"M_õppetöö\"]}[Content],\n    tunniplaan = M_õppetöö{[Name=\"TunniplaaniAI\"]}[Content],\n    CourseLinks = tunniplaan{[Name=\"CourseLinks\"]}[Content]\nin \n    CourseLinks;\r\nshared fnCourseLinks = let\r\n  fnCourseLinks = (input as binary) =>\nlet importTxt = Csv.Document(input,[Delimiter=\" \", Columns=1, Encoding=1257, QuoteStyle=QuoteStyle.None]),\n    tblDistinct =  Table.Distinct( importTxt)\nin tblDistinct\r\nin\r\n  fnCourseLinks;\r\nshared tunniplaan_kava_ainerul = let\n    Source = _folderCourseLinks,\n    #\"Added Custom\" = Table.AddColumn(Source, \"Custom\", each fnCourseLinks([Content])),\n    #\"Removed Other Columns\" = Table.SelectColumns(#\"Added Custom\",{\"Name\", \"Custom\"}),\n    #\"Extracted Text Before Delimiter\" = Table.TransformColumns(#\"Removed Other Columns\", {{\"Name\", each Text.BeforeDelimiter(_, \"_links.txt\"), type text}}),\n    #\"Expanded Custom\" = Table.ExpandTableColumn(#\"Extracted Text Before Delimiter\", \"Custom\", {\"Column1\"}, {\"aineurl\"}),\n    #\"Renamed Columns\" = Table.RenameColumns(#\"Expanded Custom\",{{\"Name\", \"kavaRyhm\"}}),\n    #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns\",{{\"aineurl\", type text}}),\n    #\"Added Custom1\" = Table.AddColumn(#\"Changed Type\", \"ainekood\", each Text.End([aineurl],7), type text),\r\n  #\"Added custom 1\" = Table.AddColumn(#\"Added Custom1\", \"kava\", each Text.Start([kavaRyhm], 4), type text)\nin\n    #\"Added custom 1\";\r\n","connectionOverrides":[{"path":"https://livettu.sharepoint.com/","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://livettu.sharepoint.com/\"}","audience":null}]},"entities":[{"$type":"LocalEntity","name":"tunniplaan_kava_ainerul","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"tunniplaan_kava_ainerul.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"kavaRyhm","dataType":"string"},{"name":"aineurl","dataType":"string"},{"name":"ainekood","dataType":"string"},{"name":"kava","dataType":"string"}]}]}