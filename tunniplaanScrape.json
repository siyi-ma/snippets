{"name":"tunniplaanScrape","version":"1.0","culture":"en-US","modifiedTime":"2025-02-08T11:42:37.1743728+00:00","ppdf:outputFileFormat":"parquet","ppdf:dataflowId":"a5fb9015-5d8e-4d7d-8446-3fffd5ddca39","ppdf:owner":{"tenantId":"3efd4d88-9b88-4fc9-b6c0-c7ca50f1db57","userId":"84427c2b-9e9c-4069-a4ef-32e34b3e92fb"},"ppdf:fastCopy":true,"pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"_folderCourseLinks":{"queryId":"5b0873e4-7e81-4cc1-99d2-2ab89b368eea","queryName":"_folderCourseLinks"},"fnCourseLinks":{"queryId":"09e162ba-e977-4d65-9eef-65d8729caba4","queryName":"fnCourseLinks"},"data_courseLinks":{"queryId":"84dd8c1a-e69e-49d4-9f45-d21e1fb0bcc2","queryName":"data_courseLinks"},"fakt_distinctAineurl":{"queryId":"d4032d33-fb36-49cd-97ab-1a4a338825a0","queryName":"fakt_distinctAineurl","loadEnabled":true}},"document":"section Section1;\r\nshared _folderCourseLinks = let\n    Source = SharePoint.Contents(\"https://livettu.sharepoint.com/sites/M_Dashboard\"),\n    M_õppetöö = Source{[Name=\"M_õppetöö\"]}[Content],\n    tunniplaan = M_õppetöö{[Name=\"TunniplaaniAI\"]}[Content],\n    CourseLinks = tunniplaan{[Name=\"CourseLinks\"]}[Content]\nin \n    CourseLinks;\r\nshared fnCourseLinks = let\r\n  fnCourseLinks = (input as binary) =>\nlet importTxt = Csv.Document(input,[Delimiter=\" \", Columns=1, Encoding=1257, QuoteStyle=QuoteStyle.None]),\n    tblDistinct =  Table.Distinct( importTxt)\nin tblDistinct\r\nin\r\n  fnCourseLinks;\r\nshared data_courseLinks = let\n    Source = _folderCourseLinks,\n    #\"Added Custom\" = Table.AddColumn(Source, \"Custom\", each fnCourseLinks([Content])),\n    #\"Removed Other Columns\" = Table.SelectColumns(#\"Added Custom\",{\"Name\", \"Custom\"}),\n    #\"Extracted Text Before Delimiter\" = Table.TransformColumns(#\"Removed Other Columns\", {{\"Name\", each Text.BeforeDelimiter(_, \"_links.txt\"), type text}}),\n    #\"Expanded Custom\" = Table.ExpandTableColumn(#\"Extracted Text Before Delimiter\", \"Custom\", {\"Column1\"}, {\"aineurl\"}),\n    #\"Renamed Columns\" = Table.RenameColumns(#\"Expanded Custom\",{{\"Name\", \"kavaRyhm\"}}),\n    #\"Changed Type\" = Table.TransformColumnTypes(#\"Renamed Columns\",{{\"aineurl\", type text}}),\n    #\"Added Custom1\" = Table.AddColumn(#\"Changed Type\", \"ainekood\", each Text.End([aineurl],7), type text)\nin\n    #\"Added Custom1\";\r\nshared fakt_distinctAineurl = let\n    Source = data_courseLinks,\n    #\"Removed Other Columns\" = Table.Distinct( Table.SelectColumns(Source,{\"aineurl\"})),\n    #\"Added Custom\" = Table.AddColumn(#\"Removed Other Columns\", \"python\", each \"\"\"\" &[aineurl] & \"\"\",\", type text),\r\n  #\"Removed other columns 1\" = Table.SelectColumns(#\"Added Custom\", {\"python\"})\nin\n    #\"Removed other columns 1\";\r\n","connectionOverrides":[{"path":"https://livettu.sharepoint.com/","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://livettu.sharepoint.com/\"}","audience":null}]},"entities":[{"$type":"LocalEntity","name":"fakt_distinctAineurl","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"fakt_distinctAineurl.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"python","dataType":"string"}]}]}