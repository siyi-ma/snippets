{"name":"tunniplaanKeywords","version":"1.0","culture":"en-US","modifiedTime":"2025-02-19T21:50:17.7989976+00:00","ppdf:outputFileFormat":"parquet","ppdf:dataflowId":"1058c1da-d06c-4388-b80d-226368a57ba5","ppdf:owner":{"tenantId":"3efd4d88-9b88-4fc9-b6c0-c7ca50f1db57","userId":"84427c2b-9e9c-4069-a4ef-32e34b3e92fb"},"ppdf:fastCopy":true,"pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"_folderTunniplaaniAI":{"queryId":"ff986b49-5852-4736-a202-03ba03983409","queryName":"_folderTunniplaaniAI"},"_taltechainetekeywords":{"queryId":"8aa9d89e-84cc-4512-b58b-e4009676006f","queryName":"_taltechainetekeywords"},"_EST_taltechKeywords":{"queryId":"82af3230-d48d-42cd-a6d6-75d67bb11a56","queryName":"_EST_taltechKeywords"},"EST_taltechKeywords":{"queryId":"1d8cb402-47fd-4147-ac5c-d93fdb984aba","queryName":"EST_taltechKeywords","loadEnabled":true},"_ENG_taltechKeywords":{"queryId":"dfa18af3-8668-4e22-8c03-3d14af4ba537","queryName":"_ENG_taltechKeywords"},"ENG_taltechKeyword":{"queryId":"5a44197f-1a68-445c-a8d7-c00dc41ce1aa","queryName":"ENG_taltechKeyword","loadEnabled":true}},"document":"section Section1;\r\nshared _folderTunniplaaniAI = let\n    Source = SharePoint.Contents(\"https://livettu.sharepoint.com/sites/M_Dashboard\"),\n    M_õppetöö = Source{[Name=\"M_õppetöö\"]}[Content],\n    tunniplaan= M_õppetöö{[Name=\"TunniplaaniAI\"]}[Content]\nin\n    tunniplaan;\r\nshared _taltechainetekeywords = let\n    Source = _folderTunniplaaniAI,\n    #\"taltech_ainete_3keywords csv\" = Source{[Name=\"taltech_ainete_keywords.csv\"]}[Content],\n    #\"Imported CSV\" = Csv.Document(#\"taltech_ainete_3keywords csv\",[Delimiter=\",\", Columns=7, Encoding=65001, QuoteStyle=QuoteStyle.Csv]),\n    #\"Promoted Headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars=true]),\n    #\"Changed Type\" = Table.TransformColumnTypes(#\"Promoted Headers\",{{\"õppeaine kood\", type text}, {\"õppeaine nimetus eesti k\", type text}, {\"õppeaine nimetus inglise k\", type text}, {\"õppeaine eesmärgid eesti k\", type text}, {\"õppeaine eesmärgid inglise k\", type text}, {\"Keywords in English\", type text}, {\"Keywords in Estonian\", type text}})\nin\n    #\"Changed Type\";\r\nshared _EST_taltechKeywords = let\r\n  Source = _taltechainetekeywords,\r\n  #\"Removed other columns\" = Table.SelectColumns(Source, {\"õppeaine kood\", \"Keywords in Estonian\"}),\r\n  #\"Split column by delimiter\" = Table.ExpandListColumn(Table.TransformColumns(#\"Removed other columns\", {{\"Keywords in Estonian\", Splitter.SplitTextByDelimiter(\", \"), let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), \"Keywords in Estonian\"),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Split column by delimiter\", {{\"Keywords in Estonian\", \"estKeyword\"}})\r\nin\r\n  #\"Renamed columns\";\r\nshared EST_taltechKeywords = let\r\n  Source = _EST_taltechKeywords,\r\n  Custom = Table.Group(Source, {\"estKeyword\"}, {{\"Count\", each Table.RowCount(_), Int64.Type}, {\"kood\", each Text.Combine( List.Transform(_[#\"õppeaine kood\"], Text.From), \", \"), type text}}),\r\n  rowCount = Table.RowCount( Custom),\r\n  #\"Sorted rows\" = Table.Sort(#\"Custom\", {{\"Count\", Order.Descending}}),\r\n  #\"Added custom\" = Table.AddColumn(#\"Sorted rows\", \"image\", each \"https://via.placeholder.com/150x150?text=\" & [estKeyword], type text)\r\nin\r\n  #\"Added custom\";\r\nshared _ENG_taltechKeywords = let\r\n  Source = _taltechainetekeywords,\r\n  #\"Removed other columns\" = Table.SelectColumns(Source, {\"õppeaine kood\", \"Keywords in English\"}),\r\n  #\"Split column by delimiter\" = Table.ExpandListColumn(Table.TransformColumns(#\"Removed other columns\", {{\"Keywords in English\", Splitter.SplitTextByDelimiter(\", \"), let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), \"Keywords in English\"),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Split column by delimiter\", {{\"Keywords in English\", \"engKeyword\"}})\r\nin\r\n  #\"Renamed columns\";\r\nshared ENG_taltechKeyword = let\r\n  Source = _ENG_taltechKeywords,\r\n  #\"Grouped rows\" = Table.Group(Source, {\"engKeyword\"}, {{\"Count\", each Table.RowCount(_), Int64.Type}, {\"kood\", each Text.Combine( List.Transform(_[#\"õppeaine kood\"], Text.From), \", \"), type text}}),\r\n  Custom = Table.RowCount( #\"Grouped rows\"),\r\n  #\"Sorted rows\" = Table.Sort(#\"Grouped rows\", {{\"Count\", Order.Descending}}),\r\n  #\"Added custom\" = Table.AddColumn(#\"Sorted rows\", \"image\", each \"https://via.placeholder.com/150x150?text=\" & [engKeyword], type text)\r\nin\r\n  #\"Added custom\";\r\n","connectionOverrides":[{"path":"https://livettu.sharepoint.com/","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://livettu.sharepoint.com/\"}","audience":null}]},"entities":[{"$type":"LocalEntity","name":"EST_taltechKeywords","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"EST_taltechKeywords.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[{\"columns\":[\"estKeyword\"]}]"}],"attributes":[{"name":"estKeyword","dataType":"string"},{"name":"Count","dataType":"int64"},{"name":"kood","dataType":"string"},{"name":"image","dataType":"string"}]},{"$type":"LocalEntity","name":"ENG_taltechKeyword","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"ENG_taltechKeyword.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[{\"columns\":[\"engKeyword\"]}]"}],"attributes":[{"name":"engKeyword","dataType":"string"},{"name":"Count","dataType":"int64"},{"name":"kood","dataType":"string"},{"name":"image","dataType":"string"}]}]}