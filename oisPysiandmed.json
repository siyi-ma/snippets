{"name":"oisPysiandmed","version":"1.0","culture":"en-US","modifiedTime":"2024-12-16T16:51:56.5530912+00:00","ppdf:outputFileFormat":"parquet","ppdf:dataflowId":"0c95b2e5-45f9-411d-8aba-c90108a13fb4","ppdf:owner":{"tenantId":"3efd4d88-9b88-4fc9-b6c0-c7ca50f1db57","userId":"84427c2b-9e9c-4069-a4ef-32e34b3e92fb"},"ppdf:fastCopy":true,"pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"DefaultDestination":{"queryId":"54c85a49-73f5-497b-97d9-7c1e79b5c274","queryName":"DefaultDestination"},"_folderOIS":{"queryId":"08009df0-a993-4e20-90ba-153991c04272","queryName":"_folderOIS"},"pysiandmed":{"queryId":"f8cc5961-d173-4ebd-82e5-c27e11a3cf1a","queryName":"pysiandmed","loadEnabled":true},"_folderOIS_DataDestination":{"queryId":"aeb6b25e-12cd-4afa-a6a0-55cd217f8f45","queryName":"_folderOIS_DataDestination"},"_folderOIS_WriteToDataDestination":{"queryId":"aae4ca03-8bc4-4b67-9507-839c38fd8e45","queryName":"_folderOIS_WriteToDataDestination"},"_folderOIS_TransformForWriteToDataDestination":{"queryId":"17020d2c-e0e1-4bed-8a5b-0cee2ae2e9e5","queryName":"_folderOIS_TransformForWriteToDataDestination"},"DefaultStaging":{"queryId":"d827e1e4-747b-4cb2-96e3-60512669a035","queryName":"DefaultStaging"},"FastCopyStaging":{"queryId":"09c83574-39ce-4fe0-a523-dd21c2faac88","queryName":"FastCopyStaging"},"pysiandmed_DataDestination":{"queryId":"d995557d-01be-4874-a806-b20d10da2e3b","queryName":"pysiandmed_DataDestination"},"pysiandmed_WriteToDataDestination":{"queryId":"8f662a6b-40cf-4fcc-a88a-4099eae93a97","queryName":"pysiandmed_WriteToDataDestination"},"pysiandmed_TransformForWriteToDataDestination":{"queryId":"f12408c2-add3-41fb-90d1-23af986315ef","queryName":"pysiandmed_TransformForWriteToDataDestination"}},"document":"section Section1;\r\nshared DefaultDestination = let\r\n  DefaultDestination = FabricSql.Contents(null){[workspaceId = \"b9ba0143-b2c1-4295-a8d9-0844282bd555\"]}[Data]{[sqlId = \"e9875463-5caf-47fd-9da1-3364d34428ce\"]}[Data]\r\nin\r\n  DefaultDestination;\r\nshared _folderOIS = let\n    Source = SharePoint.Contents(\"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee\"),\n    Documents = Source{[Name=\"Documents\"]}[Content], \n    folderOIS = Documents{[Name=\"ÕIS\"]}[Content]\nin \n  folderOIS;\r\n[Staging = \"FastCopyStaging\"]\r\nshared pysiandmed = let\r\n  Source = _folderOIS,\r\n  Navigation = Source{[Name = \"Püsiandmed.xlsx\"]}[Content],\r\n  Custom = Excel.Workbook( Navigation, null, true),\r\n  #\"Navigation 1\" = Table.FirstN( Custom{[Item = \"RLS ja nuppu\", Kind = \"Sheet\"]}[Data], 53),\r\n  #\"Removed other columns\" = Table.PromoteHeaders( Table.SelectColumns(#\"Navigation 1\", {\"Column1\", \"Column2\", \"Column3\", \"Column4\", \"Column5\", \"Column6\", \"Column7\", \"Column8\", \"Column9\", \"Column10\", \"Column11\"})),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Removed other columns\", {{\"email\", type text}, {\"role\", type text}, {\"rls_ID\", type text}, {\"rls_kava\", type text}, {\"rls_praktika\", type text}, {\"note\", type text}, {\"oppetase\", type text}, {\"hierachy\", Int64.Type}, {\"userOjectID\", type text}, {\"access\", Int64.Type}, {\"M_oisTagasisideKavaVaade\", Int64.Type}})\r\nin\r\n  #\"Changed column type\";\r\nshared _folderOIS_DataDestination = let\r\n  Target = DefaultDestination,\r\n  TableNavigation = Target{[Schema = \"dbo\", Item = \"_folderOIS\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[Name = nullable Text.Type, Extension = nullable Text.Type, #\"Date accessed\" = nullable DateTime.Type, #\"Date modified\" = nullable DateTime.Type, #\"Date created\" = nullable DateTime.Type, #\"Folder Path\" = nullable Text.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\n[Staging = \"FastCopyStaging\"]\r\nshared _folderOIS_WriteToDataDestination = let\r\n  _folderOIS_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = _folderOIS_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], _folderOIS_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  _folderOIS_WriteToDataDestination;\r\nshared _folderOIS_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(_folderOIS, {\"Name\", \"Extension\", \"Date accessed\", \"Date modified\", \"Date created\", \"Folder Path\"})\r\nin\r\n    SourceTable;\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\nshared pysiandmed_DataDestination = let\r\n  Target = DefaultDestination,\r\n  TableNavigation = Target{[Schema = \"dbo\", Item = \"pysiandmed\"]}?[Data]?,\r\n  Table = NavigationTable.CreateTableOnDemand(TableNavigation, #table(type table[email = nullable Text.Type, role = nullable Text.Type, rls_ID = nullable Text.Type, rls_kava = nullable Text.Type, rls_praktika = nullable Text.Type, note = nullable Text.Type, oppetase = nullable Text.Type, hierachy = nullable Int64.Type, userOjectID = nullable Text.Type, access = nullable Int64.Type, M_oisTagasisideKavaVaade = nullable Int64.Type], {}), [DeleteWhenEmpty = true])\r\nin\r\n  Table;\r\n[Staging = \"FastCopyStaging\"]\r\nshared pysiandmed_WriteToDataDestination = let\r\n  pysiandmed_WriteToDataDestination = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = pysiandmed_DataDestination], (txn) => {TableAction.DeleteRows(txn[Target]), () => TableAction.InsertRows(txn[Target], pysiandmed_TransformForWriteToDataDestination), Action.DoNothing}))\r\nin\r\n  pysiandmed_WriteToDataDestination;\r\nshared pysiandmed_TransformForWriteToDataDestination = let\r\n    SourceTable = Table.SelectColumns(pysiandmed, {\"email\", \"role\", \"rls_ID\", \"rls_kava\", \"rls_praktika\", \"note\", \"oppetase\", \"hierachy\", \"userOjectID\", \"access\", \"M_oisTagasisideKavaVaade\"})\r\nin\r\n    SourceTable;\r\n","connectionOverrides":[{"path":"FabricSql","kind":"FabricSql","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"FabricSql\",\"path\":\"FabricSql\"}","audience":null},{"path":"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee\"}","audience":null}]},"entities":[{"$type":"LocalEntity","name":"pysiandmed","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"pysiandmed.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"email","dataType":"string"},{"name":"role","dataType":"string"},{"name":"rls_ID","dataType":"string"},{"name":"rls_kava","dataType":"string"},{"name":"rls_praktika","dataType":"string"},{"name":"note","dataType":"string"},{"name":"oppetase","dataType":"string"},{"name":"hierachy","dataType":"int64"},{"name":"userOjectID","dataType":"string"},{"name":"access","dataType":"int64"},{"name":"M_oisTagasisideKavaVaade","dataType":"int64"}]}]}