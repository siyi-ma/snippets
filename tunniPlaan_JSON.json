{"name":"tunniPlaan_JSON","version":"1.0","culture":"en-US","modifiedTime":"2025-02-20T00:03:47.9025347+00:00","ppdf:outputFileFormat":"parquet","ppdf:dataflowId":"7ccda533-e877-4a30-8566-ceb364ff2c8c","ppdf:owner":{"tenantId":"3efd4d88-9b88-4fc9-b6c0-c7ca50f1db57","userId":"84427c2b-9e9c-4069-a4ef-32e34b3e92fb"},"ppdf:fastCopy":true,"pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"_folderTunniPlaan":{"queryId":"3a2c74b7-fd95-4539-b04b-464819b6be74","queryName":"_folderTunniPlaan"},"_folderTunniPlaanCourseData":{"queryId":"7a358a86-2f69-460a-b5ca-1940ca355504","queryName":"_folderTunniPlaanCourseData"},"_folderTaltechCourseK25":{"queryId":"0ba1cf54-ab4c-4bbb-a583-265e5bd9f9b5","queryName":"_folderTaltechCourseK25"},"fakt_courseJSON":{"queryId":"10774aa2-e32c-4aca-ab18-8e4a8202b9cb","queryName":"fakt_courseJSON","loadEnabled":true},"fakt_courseJSON_TalTech":{"queryId":"7ab38bff-4152-416b-a39f-93fb370c99df","queryName":"fakt_courseJSON_TalTech","loadEnabled":true},"_lookupKeywords":{"queryId":"20cf4df3-33d1-420c-9fd5-7f1750b6b723","queryName":"_lookupKeywords"},"fakt_TalTech_teaduskond":{"queryId":"30595830-a073-4e38-8ecd-1f6c71a0483f","queryName":"fakt_TalTech_teaduskond","loadEnabled":true}},"document":"section Section1;\r\nshared _folderTunniPlaan = let\n  Source = SharePoint.Contents(\"https://livettu.sharepoint.com/sites/M_Dashboard\"),\n  M_õppetöö = Source{[Name=\"M_õppetöö\"]}[Content],\n  tunniPlaan = M_õppetöö{[Name=\"TunniplaaniAI\"]}[Content]\nin\n  tunniPlaan;\r\nshared _folderTunniPlaanCourseData = let\n  Source = SharePoint.Contents(\"https://livettu.sharepoint.com/sites/M_Dashboard\"),\n  M_õppetöö = Source{[Name=\"M_õppetöö\"]}[Content],\n  tunniPlaan = M_õppetöö{[Name=\"TunniplaaniAI\"]}[Content],\r\n  Navigation = tunniPlaan{[Name = \"CourseData_wKeel\"]}[Content]\nin\n  Navigation;\r\nshared _folderTaltechCourseK25 = let\r\n  Source = _folderTunniPlaan,\r\n  Navigation = Source{[Name = \"CourseData_wKeel_25K\"]}[Content]\r\nin\r\n  Navigation;\r\nshared fakt_courseJSON = let\n  Source = _folderTunniPlaanCourseData,\n  addJSONcontent = Table.AddColumn(Source, \"JSONContent\", each \n        Table.ExpandRecordColumn(\n            Table.FromList( Json.Document([Content]), Splitter.SplitByNothing(), null, null, ExtraValues.Error),\n            \"Column1\", {\"Left Column\", \"Right Column\"}, {\"Field Name\", \"Value\"}), type table),\n    #\"Removed Other Columns\" = Table.SelectColumns(addJSONcontent,{\"Name\", \"JSONContent\"}),\n    #\"Extracted First Characters\" = Table.TransformColumns(#\"Removed Other Columns\", {{\"Name\", each Text.Start(_, 7), type text}}),\n    ExpandedFields = Table.ExpandTableColumn(#\"Extracted First Characters\", \"JSONContent\", {\"Field Name\", \"Value\"}, {\"Field Name\", \"Value\"}),\n    GroupedByFile = Table.Group(ExpandedFields, {\"Name\"}, {{\"Data\", each Table.Pivot(Table.TransformColumnTypes(_, {{\"Field Name\", type text}, {\"Value\", type text}}), List.Distinct(Table.Column(_, \"Field Name\")), \"Field Name\", \"Value\")}}),\n\n    // Combine all tables into one\n    CombinedTable = Table.Combine(Table.Column(GroupedByFile, \"Data\")),\n    #\"Removed Columns\" = Table.RemoveColumns(CombinedTable,{\"Name\", \"õppeaine register\", \"deklareeritav\", \"õpetamise semester\", \"Õppekavad, millesse aine kuulub\", \"õppevormid ja mahud\"})\nin\n    #\"Removed Columns\";\r\nshared fakt_courseJSON_TalTech = let\n  Source = _folderTaltechCourseK25,\n  addJSONcontent = Table.AddColumn(Source, \"JSONContent\", each \n        Table.ExpandRecordColumn(\n            Table.FromList( Json.Document([Content]), Splitter.SplitByNothing(), null, null, ExtraValues.Error),\n            \"Column1\", {\"Left Column\", \"Right Column\"}, {\"Field Name\", \"Value\"}), type table),\n    #\"Removed Other Columns\" = Table.SelectColumns(addJSONcontent,{\"Name\", \"JSONContent\"}),\n    #\"Extracted First Characters\" = Table.TransformColumns(#\"Removed Other Columns\", {{\"Name\", each Text.Start(_, 7), type text}}),\n    ExpandedFields = Table.ExpandTableColumn(#\"Extracted First Characters\", \"JSONContent\", {\"Field Name\", \"Value\"}, {\"Field Name\", \"Value\"}),\n    GroupedByFile = Table.Group(ExpandedFields, {\"Name\"}, {{\"Data\", each Table.Pivot(Table.TransformColumnTypes(_, {{\"Field Name\", type text}, {\"Value\", type text}}), List.Distinct(Table.Column(_, \"Field Name\")), \"Field Name\", \"Value\")}}),\n\n    // Combine all tables into one\n    CombinedTable = Table.Combine(Table.Column(GroupedByFile, \"Data\")),\n    #\"Removed Columns\" = Table.RemoveColumns(CombinedTable,{\"Name\", \"õppeaine register\", \"deklareeritav\", \"õpetamise semester\", \"Õppekavad, millesse aine kuulub\", \"õppevormid ja mahud\"}),\r\n  addKeywordEst = Table.TransformColumnTypes(Table.AddColumn(#\"Removed Columns\", \"keywordsEST\", each let list0 = List.Buffer(_lookupKeywords[õppeaine kood]), list1 = List.Buffer(_lookupKeywords[Keywords in Estonian]), result = try list1{List.PositionOf(list0, [õppeaine kood])} otherwise \"NA\" in result), {{\"keywordsEST\", type text}}),\r\n  Custom =   Table.TransformColumnTypes(Table.AddColumn(addKeywordEst, \"keywordsENG\", each let list0 = List.Buffer(_lookupKeywords[õppeaine kood]), list1 = List.Buffer(_lookupKeywords[Keywords in English]), result = try list1{List.PositionOf(list0, [õppeaine kood])} otherwise \"NA\" in result), {{\"keywordsENG\", type text}})\nin\n    Custom;\r\nshared _lookupKeywords = let\r\n  Source = _folderTunniPlaan,\r\n  Navigation = Source{[Name = \"taltech_ainete_keywords.csv\"]}[Content],\r\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 7, Encoding = 65001, QuoteStyle = QuoteStyle.Csv]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true])\r\nin\r\n  #\"Promoted headers\";\r\nshared fakt_TalTech_teaduskond = let\r\n  Source = fakt_courseJSON_TalTech,\r\n  #\"Removed other columns\" = Table.SelectColumns(Source, {\"õppeaine kood\", \"Ainet õpetavad struktuuriüksused\"}),\r\n  #\"Split column by delimiter\" = Table.ExpandListColumn(Table.TransformColumns(#\"Removed other columns\", {{\"Ainet õpetavad struktuuriüksused\", Splitter.SplitTextByDelimiter(\"#(lf)\"), let itemType = (type nullable text) meta [Serialized.Text = true] in type {itemType}}}), \"Ainet õpetavad struktuuriüksused\"),\r\n  #\"Added custom\" = Table.AddColumn(#\"Split column by delimiter\", \"teaduskonnakood\", each Text.Start([Ainet õpetavad struktuuriüksused], 1), type text),\r\n  #\"Grouped rows\" = Table.Group(#\"Added custom\", {\"teaduskonnakood\"}, {{\"Count\", each Table.RowCount(_), Int64.Type}, {\"ainekood\", each Text.Combine(List.Transform(_[õppeaine kood], Text.From), \", \"), type text}}),\r\n  #\"Filtered rows\" = Table.SelectRows(#\"Grouped rows\", each ([teaduskonnakood] <> \"k\")),\r\n  #\"Added custom 1\" = Table.AddColumn(#\"Filtered rows\", \"teaduskond\", each if [teaduskonnakood] = \"E\" then \"Inseneriteaduskond\" else if [teaduskonnakood] = \"I\" then \"Infotehnoloogia teaduskond\" else if [teaduskonnakood] = \"M\" then \"Majandusteaduskond\" else if [teaduskonnakood]=\"L\" then \"Loodusteaduskond\" else if [teaduskonnakood] = \"V\" then \"Eesti Mereakadeemia\" else \"NA\", type text)\r\nin\r\n  #\"Added custom 1\";\r\n","connectionOverrides":[{"path":"https://livettu.sharepoint.com/","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://livettu.sharepoint.com/\"}","audience":null}]},"entities":[{"$type":"LocalEntity","name":"fakt_courseJSON","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"fakt_courseJSON.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"õppeaine kood","dataType":"string"},{"name":"õppeaine nimetus eesti k","dataType":"string"},{"name":"õppeaine nimetus inglise k","dataType":"string"},{"name":"õppeaine maht EAP","dataType":"string"},{"name":"õppeaine täies mahus läbitav e-õppes","dataType":"string"},{"name":"kontrollivorm","dataType":"string"},{"name":"Ainet õpetavad struktuuriüksused","dataType":"string"},{"name":"Ainekaardi link","dataType":"string"},{"name":"Tunniplaani link","dataType":"string"},{"name":"õppeaine eesmärgid eesti k","dataType":"string"},{"name":"õppeaine eesmärgid inglise k","dataType":"string"},{"name":"õppeaine õpiväljundid eesti k.","dataType":"string"},{"name":"õppeaine õpiväljundid ingl k.","dataType":"string"},{"name":"õppeaine sisu lühikirjeldus eesti k","dataType":"string"},{"name":"õppeaine sisu lühikirjeldus ingl k","dataType":"string"},{"name":"hindamisviis eesti k","dataType":"string"},{"name":"hindamisviis ingl k","dataType":"string"},{"name":"iseseisev töö eesti k","dataType":"string"},{"name":"iseseisev töö ingl k","dataType":"string"},{"name":"õppekirjandus","dataType":"string"},{"name":"KEEL_et","dataType":"string"},{"name":"KEEL_en","dataType":"string"},{"name":"Eeldusaine(d)","dataType":"string"},{"name":"Aine on eelduseks","dataType":"string"}]},{"$type":"LocalEntity","name":"fakt_courseJSON_TalTech","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"fakt_courseJSON_TalTech.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"õppeaine kood","dataType":"string"},{"name":"õppeaine nimetus eesti k","dataType":"string"},{"name":"õppeaine nimetus inglise k","dataType":"string"},{"name":"õppeaine maht EAP","dataType":"string"},{"name":"õppeaine täies mahus läbitav e-õppes","dataType":"string"},{"name":"kontrollivorm","dataType":"string"},{"name":"Ainet õpetavad struktuuriüksused","dataType":"string"},{"name":"Ainekaardi link","dataType":"string"},{"name":"Tunniplaani link","dataType":"string"},{"name":"õppeaine eesmärgid eesti k","dataType":"string"},{"name":"õppeaine eesmärgid inglise k","dataType":"string"},{"name":"õppeaine õpiväljundid eesti k.","dataType":"string"},{"name":"õppeaine õpiväljundid ingl k.","dataType":"string"},{"name":"õppeaine sisu lühikirjeldus eesti k","dataType":"string"},{"name":"õppeaine sisu lühikirjeldus ingl k","dataType":"string"},{"name":"hindamisviis eesti k","dataType":"string"},{"name":"hindamisviis ingl k","dataType":"string"},{"name":"iseseisev töö eesti k","dataType":"string"},{"name":"iseseisev töö ingl k","dataType":"string"},{"name":"õppekirjandus","dataType":"string"},{"name":"KEEL_et","dataType":"string"},{"name":"KEEL_en","dataType":"string"},{"name":"Aine on eelduseks","dataType":"string"},{"name":"Eeldusaine(d)","dataType":"string"},{"name":"keywordsEST","dataType":"string"},{"name":"keywordsENG","dataType":"string"}]},{"$type":"LocalEntity","name":"fakt_TalTech_teaduskond","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"fakt_TalTech_teaduskond.parquet"},"annotations":[{"name":"pbi:EntityTypeDisplayHint","value":"CalculatedEntity"},{"name":"ppdf:entityKeys","value":"[{\"columns\":[\"teaduskonnakood\"]}]"}],"attributes":[{"name":"teaduskonnakood","dataType":"string"},{"name":"Count","dataType":"int64"},{"name":"ainekood","dataType":"string"},{"name":"teaduskond","dataType":"string"}]}]}