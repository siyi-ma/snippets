{"name":"M_yliopilaste_vastuvottprognoos","version":"1.0","culture":"en-US","modifiedTime":"2025-04-30T07:25:55.1564237+00:00","ppdf:outputFileFormat":"parquet","ppdf:dataflowId":"77896ce5-64e6-490f-9a0d-aac63247e764","ppdf:owner":{"tenantId":"3efd4d88-9b88-4fc9-b6c0-c7ca50f1db57","userId":"84427c2b-9e9c-4069-a4ef-32e34b3e92fb"},"ppdf:fastCopy":true,"pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"pythonARIMA_prognoos":{"queryId":"d19c23d3-308a-445a-b827-9eb1aa2b04fb","queryName":"pythonARIMA_prognoos"},"wkin2025":{"queryId":"50153dc1-e64c-40c5-82c9-0c705dd23ee1","queryName":"wkin2025"},"prognoos":{"queryId":"8c112ff1-81d4-4ee5-94b3-c2580db81357","queryName":"prognoos","loadEnabled":true},"_folderVVstat_csv":{"queryId":"845acc1b-cfb4-4bad-8c0f-7599a3e44cb2","queryName":"_folderVVstat_csv"},"ga4_pageviews_vv_kvalifitseeruv":{"queryId":"dbf9d093-8aa9-4c54-97bf-d7049c09e4db","queryName":"ga4_pageviews_vv_kvalifitseeruv"},"_lookup_pythonARIMA_wkkey":{"queryId":"bf7142d1-128a-4861-875d-b3b31fb632b2","queryName":"_lookup_pythonARIMA_wkkey"},"fakt_pythonARIMA_prognoos":{"queryId":"657c7adb-a4df-47fb-9a8d-3949cfff1861","queryName":"fakt_pythonARIMA_prognoos","loadEnabled":true},"_folderVScode_vastuvott":{"queryId":"6847f7c9-1b4d-4cfb-8a70-420e9dcc6800","queryName":"_folderVScode_vastuvott"}},"document":"section Section1;\r\nshared pythonARIMA_prognoos = let\r\n  Source = _folderVVstat_csv,\r\n  #\"Sorted rows\" = Table.Sort(Source, {{\"Date created\", Order.Descending}}),\r\n  Navigation = #\"Sorted rows\"{1}[Content],\r\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 6, QuoteStyle = QuoteStyle.None]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true]),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Promoted headers\", {{\"aasta\", Int64.Type}, {\"wk\", Int64.Type}, {\"key\", type text}, {\"kava\", type text}, {\"ga4pageViews\", Int64.Type}, {\"kumlkvalifitseeruv\", Int64.Type}})\r\nin\r\n  #\"Changed column type\";\r\nshared wkin2025 = let\n    StartDate = #date(2025, 3, 4), // Approx start of week 10\n    EndDate = #date(2025, 9, 30),  // Approx end of week 39\n    DateList = List.Dates(StartDate, Duration.Days(EndDate - StartDate) + 1, #duration(1, 0, 0, 0)),\n    TableFromList = Table.FromList(DateList, Splitter.SplitByNothing(), {\"Date\"}),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(TableFromList, {{\"Date\", type date}}),\n    AddWeekNum = Table.AddColumn(#\"Changed column type\", \"wk\", each Date.WeekOfYear([Date], Day.Monday), Int64.Type),\n    AddYear = Table.AddColumn(AddWeekNum, \"aasta\", each 2025, Int64.Type),\n    FilterWeeks = Table.SelectRows(AddYear, each [wk] >= 10 and [wk] <= 39),\n    AddKey = Table.AddColumn(FilterWeeks, \"key\", each Date.ToText([Date], \"d.MM\"), type text),\n    addModulo = Table.RemoveColumns( Table.AddColumn (Table.AddIndexColumn(AddKey, \"Index\", 0, 1, Int64.Type), \"Modulo\", each Number.Mod([Index], 7), Int64.Type), {\"Index\"}),\n    filterRows = Table.SelectRows(addModulo, each ([Modulo] = 0)),\r\n  #\"Removed columns\" = Table.RemoveColumns(filterRows, {\"Modulo\"})\nin\n    #\"Removed columns\";\r\nshared prognoos = let\r\n  Source = wkin2025,\r\n  #\"Merged queries\" = Table.NestedJoin(Source, {\"aasta\", \"key\"}, ga4_pageviews_vv_kvalifitseeruv, {\"aasta\", \"key\"}, \"ga4_pageviews_vv_kvalifitseeruv\", JoinKind.LeftOuter),\r\n  #\"Expanded ga4_pageviews_vv_kvalifitseeruv\" = Table.ExpandTableColumn(#\"Merged queries\", \"ga4_pageviews_vv_kvalifitseeruv\", {\"kava\", \"ga4pageViews\", \"kumlkvalifitseeruv\"}, {\"kava\", \"ga4pageViews\", \"applications\"})\r\nin\r\n  #\"Expanded ga4_pageviews_vv_kvalifitseeruv\";\r\nshared _folderVVstat_csv = let\n    Source = SharePoint.Contents(\"https://livettu.sharepoint.com/sites/M_admin\"),\n    Documents = Source{[Name=\"Documents\"]}[Content],\n    A_Oppetegevuse_failid = Documents{[Name=\"A_Õppetegevuse failid\"]}[Content],\n    vastuvott = A_Oppetegevuse_failid{[Name=\"Vastuvõtt\"]}[Content],\n    statistikavv = vastuvott {[Name=\"Statistika vastuvõtt\"]} [Content],\n    csv = statistikavv{[Name=\"csv\"]}[Content]\nin \n    csv;\r\nshared ga4_pageviews_vv_kvalifitseeruv = let\r\n  Source = _folderVScode_vastuvott,\r\n  Navigation = Source{[Name = \"ga4_vastuvott_prognoos2025.csv\"]}[Content],\r\n  #\"Imported CSV\" = Csv.Document(Navigation, [Delimiter = \",\", Columns = 6, Encoding = 65001, QuoteStyle = QuoteStyle.None]),\r\n  #\"Promoted headers\" = Table.PromoteHeaders(#\"Imported CSV\", [PromoteAllScalars = true]),\r\n  #\"Changed column type\" = Table.TransformColumnTypes(#\"Promoted headers\", {{\"aasta\", Int64.Type}, {\"wk\", Int64.Type}, {\"key\", type text}, {\"kava\", type text}, {\"ga4pageViews\", Int64.Type}, {\"kumlkvalifitseeruv\", Int64.Type}})\r\nin\r\n  #\"Changed column type\";\r\nshared _lookup_pythonARIMA_wkkey = let\r\n  Source = pythonARIMA_prognoos,\r\n  #\"Removed other columns\" = Table.Distinct(Table.SelectColumns(Source, {\"wk\", \"key\"})),\r\n  #\"Filtered rows\" = Table.SelectRows(#\"Removed other columns\", each ([key] <> \"\")),\r\n  #\"Renamed columns\" = Table.RenameColumns(#\"Filtered rows\", {{\"wk\", \"lkwk\"}, {\"key\", \"lkkey\"}})\r\nin\r\n  #\"Renamed columns\";\r\nshared fakt_pythonARIMA_prognoos = let\r\n  Source = pythonARIMA_prognoos,\r\n  #\"Added custom\" = Table.AddColumn(Source, \"Custom\", each let list0= List.Buffer(_lookup_pythonARIMA_wkkey[lkwk]), list1 =  List.Buffer(_lookup_pythonARIMA_wkkey[lkkey]),\r\nkeyvalue = list1{List.PositionOf(list0, [wk])},\r\nresult = if [key] =\"\" then keyvalue else [key] in result, type text),\r\n  #\"Removed columns\" = Table.RenameColumns( Table.RemoveColumns(#\"Added custom\", {\"key\"}), {{\"Custom\", \"key\"}}),\r\n  #\"Sorted rows\" = Table.Sort(#\"Removed columns\", {{\"aasta\", Order.Descending}, {\"wk\", Order.Ascending}})\r\nin\r\n  #\"Sorted rows\";\r\nshared _folderVScode_vastuvott = let\n  Source = SharePoint.Contents(\"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee\"),\n  Documents = Source{[Name=\"Documents\"]}[Content], \n  folderVScode = Documents{[Name=\"VScode\"]}[Content],\r\n  Navigation = folderVScode{[Name = \"vastuvott\"]}[Content]\nin\n  Navigation;\r\n","connectionOverrides":[{"path":"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://livettu-my.sharepoint.com/personal/siyi_ma_taltech_ee\"}","audience":null},{"path":"GoogleBigQuery","kind":"GoogleBigQuery","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"GoogleBigQuery\",\"path\":\"GoogleBigQuery\"}","audience":null},{"path":"PowerPlatformDataflows","kind":"PowerPlatformDataflows","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"PowerPlatformDataflows\",\"path\":\"PowerPlatformDataflows\"}","audience":null},{"path":"https://livettu.sharepoint.com/sites/M_admin","kind":"SharePoint","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"SharePoint\",\"path\":\"https://livettu.sharepoint.com/sites/M_admin\"}","audience":null}]},"entities":[{"$type":"LocalEntity","name":"prognoos","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"prognoos.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"Date","dataType":"date"},{"name":"wk","dataType":"int64"},{"name":"aasta","dataType":"int64"},{"name":"key","dataType":"string"},{"name":"kava","dataType":"string"},{"name":"ga4pageViews","dataType":"int64"},{"name":"applications","dataType":"int64"}]},{"$type":"LocalEntity","name":"fakt_pythonARIMA_prognoos","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"fakt_pythonARIMA_prognoos.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"aasta","dataType":"int64"},{"name":"wk","dataType":"int64"},{"name":"kava","dataType":"string"},{"name":"ga4pageViews","dataType":"int64"},{"name":"kumlkvalifitseeruv","dataType":"int64"},{"name":"key","dataType":"string"}]}]}